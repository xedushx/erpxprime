/*
 Basic Primitives orgDiagram v1.0.37

 (c) Basic Primitives Inc

 License: http://www.basicprimitives.com/redirectto/license.html

*/
(function(){var a=function(a){var a=a.split("."),c=window,d;for(d=0;d<a.length;d+=1)c=c[a[d]]=c[a[d]]||{};return c};a("primitives.common");a("primitives.orgdiagram");a("primitives.text");a("primitives.callout")})();primitives.common.isNullOrEmpty=function(a){var b=!0;void 0!==a&&null!==a&&(a=a.toString(),0<a.length&&(b=!1));return b};primitives.common.hashCode=function(a){var b=0,c,d;if(0<a.length)for(d=0;d<a.length;d+=1)c=a.charCodeAt(d),b=(b<<5)-b+c,b&=b;return b};
primitives.common.attr=function(a,b){var c,d;if(a.hasOwnProperty("attrHash"))for(c in b)b.hasOwnProperty(c)&&(d=b[c],a.attrHash[c]!=d&&(a.attrHash[c]=d,a.attr(c,d)));else a.attr(b),a.attrHash=b};primitives.common.css=function(a,b){var c,d;if(a.hasOwnProperty("cssHash"))for(c in b)b.hasOwnProperty(c)&&(d=b[c],a.cssHash[c]!=d&&(a.cssHash[c]=d,a.css(c,d)));else a.css(b),a.cssHash=b};
primitives.common.stopPropagation=function(a){void 0!==a.stopPropagation?a.stopPropagation():void 0!==a.cancelBubble?a.cancelBubble=!0:void 0!==a.preventDefault&&a.preventDefault()};primitives.common.indexOf=function(a,b){var c,d;for(c=0;c<a.length;c+=1)if(d=a[c],d===b)return c;return-1};primitives.common._supportsSVG=null;
primitives.common.supportsSVG=function(){null===primitives.common._supportsSVG&&(primitives.common._supportsSVG=document.implementation.hasFeature("http://www.w3.org/TR/SVG11/feature#BasicStructure","1.1")||document.implementation.hasFeature("http://www.w3.org/TR/SVG11/feature#Shape","1.0"));return primitives.common._supportsSVG};primitives.common._supportsVML=null;
primitives.common.supportsVML=function(){var a,b;null===primitives.common._supportsVML&&(primitives.common._supportsVML=!1,jQuery.support.opacity||(a=document.createElement("div"),a=document.body.appendChild(a),a.innerHTML='<v:shape adj="1" />',b=a.firstChild,b.style.behavior="url(#default#VML)",primitives.common._supportsVML=b?"object"===typeof b.adj:!1,a.parentNode.removeChild(a)));return primitives.common._supportsVML};primitives.common._supportsCanvas=null;
primitives.common.supportsCanvas=function(){null===primitives.common._supportsCanvas&&(primitives.common._supportsCanvas=!!window.HTMLCanvasElement);return primitives.common._supportsCanvas};
primitives.common.createGraphics=function(a,b){var c=null,d,e;d=[a];for(e in primitives.common.GraphicsType)primitives.common.GraphicsType.hasOwnProperty(e)&&d.push(primitives.common.GraphicsType[e]);for(e=0;null===c&&e<d.length;e+=1)switch(d[e]){case 2:primitives.common.supportsVML()&&(c=new primitives.common.VmlGraphics(b));break;case 0:primitives.common.supportsSVG()&&(c=new primitives.common.SvgGraphics(b));break;case 1:primitives.common.supportsCanvas()&&(c=new primitives.common.CanvasGraphics(b))}return c};
primitives.common.getColorHexValue=function(a){var b,c,d;if("#"===a.substr(0,1))return a;b=/(.*?)rgb\((\d+), (\d+), (\d+)\)/.exec(a);if(null!==b&&0<b.length)return a=parseInt(b[2],10),c=parseInt(b[3],10),d=parseInt(b[4],10),a=(a<<16|c<<8|d).toString(16),b[1]+"000000".substr(0,6-a.length)+a;if(void 0===primitives.common.ColorHexs)for(c in primitives.common.ColorHexs={},primitives.common.Colors)primitives.common.Colors.hasOwnProperty(c)&&(primitives.common.ColorHexs[c.toUpperCase()]=primitives.common.Colors[c]);
return primitives.common.ColorHexs[a.toUpperCase()]};primitives.common.getColorName=function(a){var b,a=primitives.common.getColorHexValue(a);if(void 0===primitives.common.ColorNames)for(b in primitives.common.ColorNames={},primitives.common.Colors)primitives.common.Colors.hasOwnProperty(b)&&(primitives.common.ColorNames[primitives.common.Colors[b]]=b);return primitives.common.ColorNames[a]};primitives.common.getRed=function(a){return"#"===a.substr(0,1)&&7===a.length?parseInt(a.substr(1,2),16):null};
primitives.common.getGreen=function(a){return"#"===a.substr(0,1)&&7===a.length?parseInt(a.substr(3,2),16):null};primitives.common.getBlue=function(a){return"#"===a.substr(0,1)&&7===a.length?parseInt(a.substr(5,2),16):null};
primitives.common.beforeOpacity=function(a,b){var c=primitives.common,d,e,a=c.getColorHexValue(a);d=Math.ceil((c.getRed(a)-255*(1-b))/b);e=Math.ceil((c.getRed(a)-255*(1-b))/b);c=Math.ceil((c.getRed(a)-255*(1-b))/b);d=(d<<16|e<<8|c).toString(16);return"#"+"000000".substr(0,6-d.length)+d};
primitives.common.highestContrast=function(a,b,c){var d=b,e=primitives.common,f=a+","+b+","+c;void 0===e.highestContrasts&&(e.highestContrasts={});e.highestContrasts.hasOwnProperty(f)?d=e.highestContrasts[f]:(e.luminosity(b,a)<e.luminosity(c,a)&&(d=c),e.highestContrasts[f]=d);return d};
primitives.common.luminosity=function(a,b){var c=primitives.common,d=c.getColorHexValue(a),e=c.getColorHexValue(b),d=0.2126*Math.pow(c.getRed(d)/255,2.2)+0.7152*Math.pow(c.getRed(d)/255,2.2)+0.0722*Math.pow(c.getRed(d)/255,2.2),c=0.2126*Math.pow(c.getRed(e)/255,2.2)+0.7152*Math.pow(c.getRed(e)/255,2.2)+0.0722*Math.pow(c.getRed(e)/255,2.2);return d>c?(d+0.05)/(c+0.05):(c+0.05)/(d+0.05)};var mouseHandled2=!1;jQuery(document).mouseup(function(){mouseHandled2=!1});
jQuery.widget("ui.mouse2",{version:"1.10.1",options:{cancel:"input,textarea,button,select,option",distance:1,delay:0},_mouseInit:function(a){var b=this;this.element2=a;this.element2.bind("mousedown."+this.widgetName,function(a){return b._mouseDown(a)}).bind("click."+this.widgetName,function(a){if(!0===jQuery.data(a.target,b.widgetName+".preventClickEvent"))return jQuery.removeData(a.target,b.widgetName+".preventClickEvent"),a.stopImmediatePropagation(),!1});this.started=!1},_mouseDestroy:function(){this.element2.unbind("."+
this.widgetName);this._mouseMoveDelegate&&jQuery(document).unbind("mousemove."+this.widgetName,this._mouseMoveDelegate).unbind("mouseup."+this.widgetName,this._mouseUpDelegate)},_mouseDown:function(a){if(!mouseHandled2){this._mouseStarted&&this._mouseUp(a);this._mouseDownEvent=a;var b=this,c=1===a.which,d="string"===typeof this.options.cancel&&a.target.nodeName?jQuery(a.target).closest(this.options.cancel).length:!1;if(!c||d||!this._mouseCapture(a))return!0;this.mouseDelayMet=!this.options.delay;
this.mouseDelayMet||(this._mouseDelayTimer=setTimeout(function(){b.mouseDelayMet=!0},this.options.delay));if(this._mouseDistanceMet(a)&&this._mouseDelayMet(a)&&(this._mouseStarted=!1!==this._mouseStart(a),!this._mouseStarted))return a.preventDefault(),!0;!0===jQuery.data(a.target,this.widgetName+".preventClickEvent")&&jQuery.removeData(a.target,this.widgetName+".preventClickEvent");this._mouseMoveDelegate=function(a){return b._mouseMove(a)};this._mouseUpDelegate=function(a){return b._mouseUp(a)};
jQuery(document).bind("mousemove."+this.widgetName,this._mouseMoveDelegate).bind("mouseup."+this.widgetName,this._mouseUpDelegate);a.preventDefault();return mouseHandled2=!0}},_mouseMove:function(a){if(jQuery.ui.ie&&(!document.documentMode||9>document.documentMode)&&!a.button)return this._mouseUp(a);if(this._mouseStarted)return this._mouseDrag(a),a.preventDefault();this._mouseDistanceMet(a)&&this._mouseDelayMet(a)&&((this._mouseStarted=!1!==this._mouseStart(this._mouseDownEvent,a))?this._mouseDrag(a):
this._mouseUp(a));return!this._mouseStarted},_mouseUp:function(a){jQuery(document).unbind("mousemove."+this.widgetName,this._mouseMoveDelegate).unbind("mouseup."+this.widgetName,this._mouseUpDelegate);this._mouseStarted&&(this._mouseStarted=!1,a.target===this._mouseDownEvent.target&&jQuery.data(a.target,this.widgetName+".preventClickEvent",!0),this._mouseStop(a));return!1},_mouseDistanceMet:function(a){return Math.max(Math.abs(this._mouseDownEvent.pageX-a.pageX),Math.abs(this._mouseDownEvent.pageY-
a.pageY))>=this.options.distance},_mouseDelayMet:function(){return this.mouseDelayMet},_mouseStart:function(){},_mouseDrag:function(){},_mouseStop:function(){},_mouseCapture:function(){return!0}});primitives.orgdiagram.AdviserPlacementType={Auto:0,Left:2,Right:3};primitives.orgdiagram.UpdateMode={Recreate:0,Refresh:1,PositonHighlight:2};primitives.text.TextOrientationType={Horizontal:0,RotateLeft:1,RotateRight:2,Auto:3};primitives.orgdiagram.SelectionPathMode={None:0,FullStack:1};
primitives.common.SegmentType={Line:0,Move:1,QuadraticArc:2,CubicArc:3,Dot:4};primitives.common.RenderingMode={Create:0,Update:1};primitives.common.PlacementType={Auto:0,Top:1,TopRight:2,Right:3,BottomRight:4,Bottom:5,BottomLeft:6,Left:7,TopLeft:8};primitives.orgdiagram.PageFitMode={None:0,PageWidth:1,PageHeight:2,FitToPage:3};primitives.orgdiagram.OrientationType={Top:0,Bottom:1,Left:2,Right:3};primitives.orgdiagram.Layers={Connector:1,Highlight:2,Marker:3,Label:4,Cursor:5,Item:6,Annotation:7};
primitives.common.LabelType={Regular:0,Dummy:1,Fixed:2};primitives.orgdiagram.ItemType={Regular:0,Assistant:1,Adviser:2,Invisible:3,SubAssistant:4,SubAdviser:5};primitives.common.HorizontalAlignmentType={Center:0,Left:1,Right:2};primitives.common.GraphicsType={SVG:0,Canvas:1,VML:2};primitives.common.Enabled={Auto:0,True:1,False:2};primitives.orgdiagram.ConnectorType={Squared:0,Angular:1,Curved:2};
primitives.common.Colors={AliceBlue:"#f0f8ff",AntiqueWhite:"#faebd7",Aqua:"#00ffff",Aquamarine:"#7fffd4",Azure:"#f0ffff",Beige:"#f5f5dc",Bisque:"#ffe4c4",Black:"#000000",BlanchedAlmond:"#ffebcd",Blue:"#0000ff",BlueViolet:"#8a2be2",Brown:"#a52a2a",BurlyWood:"#deb887",Bronze:"#cd7f32",CadetBlue:"#5f9ea0",ChartReuse:"#7fff00",Chocolate:"#d2691e",Coral:"#ff7f50",CornflowerBlue:"#6495ed",Cornsilk:"#fff8dc",Crimson:"#dc143c",Cyan:"#00ffff",DarkBlue:"#00008b",DarkCyan:"#008b8b",DarkGoldenrod:"#b8860b",DarkGray:"#a9a9a9",
DarkGreen:"#006400",DarkKhaki:"#bdb76b",DarkMagenta:"#8b008b",DarkOliveGreen:"#556b2f",Darkorange:"#ff8c00",DarkOrchid:"#9932cc",DarkRed:"#8b0000",DarkSalmon:"#e9967a",DarkSeaGreen:"#8fbc8f",DarkSlateBlue:"#483d8b",DarkSlateGray:"#2f4f4f",DarkTurquoise:"#00ced1",DarkViolet:"#9400d3",DeepPink:"#ff1493",DeepSkyBlue:"#00bfff",DimGray:"#696969",DodgerBlue:"#1e90ff",FireBrick:"#b22222",FloralWhite:"#fffaf0",ForestGreen:"#228b22",Fuchsia:"#ff00ff",Gainsboro:"#dcdcdc",GhostWhite:"#f8f8ff",Gold:"#ffd700",
Goldenrod:"#daa520",Gray:"#808080",Green:"#008000",GreenYellow:"#adff2f",Honeydew:"#f0fff0",Hotpink:"#ff69b4",IndianRed:"#cd5c5c",Indigo:"#4b0082",Ivory:"#fffff0",Khaki:"#f0e68c",Lavender:"#e6e6fa",LavenderBlush:"#fff0f5",Lawngreen:"#7cfc00",Lemonchiffon:"#fffacd",LightBlue:"#add8e6",LightCoral:"#f08080",LightCyan:"#e0ffff",LightGoldenrodYellow:"#fafad2",LightGray:"#d3d3d3",LightGreen:"#90ee90",LightPink:"#ffb6c1",LightSalmon:"#ffa07a",LightSeaGreen:"#20b2aa",LightSkyBlue:"#87cefa",LightSlateGray:"#778899",
LightSteelBlue:"#b0c4de",LightYellow:"#ffffe0",Lime:"#00ff00",Limegreen:"#32cd32",Linen:"#faf0e6",Magenta:"#ff00ff",Maroon:"#800000",MediumAquamarine:"#66cdaa",MediumBlue:"#0000cd",MediumOrchid:"#ba55d3",MediumPurple:"#9370d8",MediumSeaGreen:"#3cb371",MediumSlateBlue:"#7b68ee",MediumSpringGreen:"#00fa9a",MediumTurquoise:"#48d1cc",MediumVioletRed:"#c71585",MidnightBlue:"#191970",MintCream:"#f5fffa",MistyRose:"#ffe4e1",Moccasin:"#ffe4b5",NavajoWhite:"#ffdead",Navy:"#000080",Oldlace:"#fdf5e6",Olive:"#808000",
Olivedrab:"#6b8e23",Orange:"#ffa500",OrangeRed:"#ff4500",Orchid:"#da70d6",PaleGoldenRod:"#eee8aa",PaleGreen:"#98fb98",PaleTurquoise:"#afeeee",PaleVioletRed:"#d87093",Papayawhip:"#ffefd5",Peachpuff:"#ffdab9",Peru:"#cd853f",Pink:"#ffc0cb",Plum:"#dda0dd",PowderBlue:"#b0e0e6",Purple:"#800080",Red:"#ff0000",RosyBrown:"#bc8f8f",RoyalBlue:"#4169e1",SaddleBrown:"#8b4513",Salmon:"#fa8072",SandyBrown:"#f4a460",SeaGreen:"#2e8b57",Seashell:"#fff5ee",Sienna:"#a0522d",Silver:"#c0c0c0",SkyBlue:"#87ceeb",SlateBlue:"#6a5acd",
SlateGray:"#708090",Snow:"#fffafa",SpringGreen:"#00ff7f",SteelBlue:"#4682b4",Tan:"#d2b48c",Teal:"#008080",Thistle:"#d8bfd8",Tomato:"#ff6347",Turquoise:"#40e0d0",Violet:"#ee82ee",Wheat:"#f5deb3",White:"#ffffff",WhiteSmoke:"#f5f5f5",Yellow:"#ffff00",YellowGreen:"#9acd32"};primitives.orgdiagram.ChildrenPlacementType={Auto:0,Vertical:1,Horizontal:2,Matrix:3};primitives.common.VerticalAlignmentType={Top:0,Middle:1,Bottom:2};primitives.orgdiagram.Visibility={Auto:0,Normal:1,Dot:2,Line:3,Invisible:4};
primitives.orgdiagram.EventArgs=function(){this.name=this.position=this.parentItem=this.context=this.oldContext=null;this.cancel=!1};primitives.common.RenderEventArgs=function(){this.renderingMode=this.templateName=this.context=this.element=null;this.isSelected=this.isCursor=!1};
primitives.common.Callout=function(a){this.m_graphics=a;this.pointerPlacement=0;this.cornerRadius="10%";this.offset=0;this.lineWidth=this.opacity=1;this.pointerWidth="10%";this.borderColor="#000000";this.fillColor="#d3d3d3";this.m_map=[[8,7,6],[1,null,5],[2,3,4]]};
primitives.common.Callout.prototype.draw=function(a,b){var b=(new primitives.common.Rect(b)).offset(this.offset),c=new primitives.common.Point(b.x,b.y),d=new primitives.common.Point(b.right(),b.y),e=new primitives.common.Point(b.right(),b.bottom()),f=new primitives.common.Point(b.left(),b.bottom()),g=[null,null,null,null,null,null,null,null],f=[c,d,e,f],d=this.m_graphics.getPxSize(this.cornerRadius,Math.min(c.distanceTo(d),d.distanceTo(e))),h;null!==a&&(c=0===this.pointerPlacement?this._getPlacement(a,
c,e):this.pointerPlacement,null!==c&&(g[c]=a));c=[];for(h=0;h<f.length;h+=1)this._drawSegment(c,f[0],f[1],f[2],this.pointerWidth,d,g[1],g[2]),e=f.shift(),f.push(e),e=g.shift(),g.push(e),e=g.shift(),g.push(e);g={};null!==this.fillColor&&(g.fillColor=this.fillColor,g.opacity=this.opacity);null!==this.borderColor&&(g.borderColor=this.borderColor);g.lineWidth=this.lineWidth;this.m_graphics.polyline(c,g)};
primitives.common.Callout.prototype._getPlacement=function(a,b,c){var d=null,e=null,d=a.x<b.x?0:a.x>c.x?2:1,e=a.y<b.y?0:a.y>c.y?2:1;return this.m_map[d][e]};
primitives.common.Callout.prototype._drawSegment=function(a,b,c,d,e,f,g,h){var i=this._offsetPoint(b,c,f),j=this._offsetPoint(c,b,f),d=this._offsetPoint(c,d,f),e=this.m_graphics.getPxSize(e,b.distanceTo(c)/2);0===a.length&&a.push(new primitives.common.MoveSegment(i));null!==g&&(i=this._betweenPoint(b,c),b=this._offsetPoint(i,b,e),e=this._offsetPoint(i,c,e),a.push(new primitives.common.LineSegment(b)),a.push(new primitives.common.LineSegment(g)),a.push(new primitives.common.LineSegment(e)));a.push(new primitives.common.LineSegment(j));
null!==h?(a.push(new primitives.common.LineSegment(h)),a.push(new primitives.common.LineSegment(d))):a.push(new primitives.common.QuadraticArcSegment(c,d))};primitives.common.Callout.prototype._betweenPoint=function(a,b){return new primitives.common.Point((a.x+b.x)/2,(a.y+b.y)/2)};primitives.common.Callout.prototype._offsetPoint=function(a,b,c){var d=new primitives.common.Point(a);a.x<b.x?d.x+=c:a.x>b.x?d.x-=c:d.y=a.y<b.y?d.y+c:d.y-c;return d};
primitives.common.Point=function(a,b){this.y=this.x=null;switch(arguments.length){case 1:this.x=a.x;this.y=a.y;break;case 2:this.x=a,this.y=b}};primitives.common.Point.prototype.distanceTo=function(a,b){var c=0,d=0;switch(arguments.length){case 1:c=a.x;d=a.y;break;case 2:c=a,d=b}c=this.x-c;d=this.y-d;return Math.sqrt(c*c+d*d)};primitives.common.Point.prototype.toString=function(a){var b,a=void 0!==a?a:"px";b=""+("left:"+this.x+a+";");return b+="top:"+this.y+a+";"};
primitives.common.CubicArcSegment=function(a,b,c,d,e,f){this.cpY2=this.cpX2=this.cpY1=this.cpX1=this.y=this.x=null;switch(arguments.length){case 3:this.x=c.x;this.y=c.y;this.cpX1=a.x;this.cpY1=a.y;this.cpX2=b.x;this.cpY2=b.y;break;case 6:this.cpX1=a,this.cpY1=b,this.cpX2=c,this.cpY2=d,this.x=e,this.y=f}this.segmentType=3};primitives.common.DotSegment=function(a,b,c){this.segmentType=4;this.x=a;this.y=b;this.radius=c};
primitives.common.Label=function(){this.position=this.text=null;this.weight=0;this.isActive=!0;this.labelType=primitives.common.LabelType.Regular;this.horizontalAlignmentType=this.labelOrientation=0;this.verticalAlignmentType=2};primitives.common.LineSegment=function(){this.parent=primitives.common.Point.prototype;this.parent.constructor.apply(this,arguments);this.segmentType=0};primitives.common.LineSegment.prototype=new primitives.common.Point;
primitives.common.MoveSegment=function(){this.parent=primitives.common.Point.prototype;this.parent.constructor.apply(this,arguments);this.segmentType=1};primitives.common.LineSegment.prototype=new primitives.common.Point;primitives.common.QuadraticArcSegment=function(a,b,c,d){this.cpY=this.cpX=this.y=this.x=null;switch(arguments.length){case 2:this.x=b.x;this.y=b.y;this.cpX=a.x;this.cpY=a.y;break;case 4:this.cpX=a,this.cpY=b,this.x=c,this.y=d}this.segmentType=2};
primitives.common.Rect=function(a,b,c,d){this.height=this.width=this.y=this.x=null;switch(arguments.length){case 1:this.x=a.x;this.y=a.y;this.width=a.width;this.height=a.height;break;case 2:this.x=Math.min(a.x,b.x);this.y=Math.min(a.y,b.y);this.width=Math.abs(b.x-a.x);this.height=Math.abs(b.y-a.y);break;case 4:this.x=a,this.y=b,this.width=c,this.height=d}};primitives.common.Rect.prototype.left=function(){return this.x};primitives.common.Rect.prototype.top=function(){return this.y};
primitives.common.Rect.prototype.right=function(){return this.x+this.width};primitives.common.Rect.prototype.bottom=function(){return this.y+this.height};primitives.common.Rect.prototype.verticalCenter=function(){return this.y+this.height/2};primitives.common.Rect.prototype.horizontalCenter=function(){return this.x+this.width/2};primitives.common.Rect.prototype.isEmpty=function(){return null===this.x||null===this.y||null===this.width||null===this.height||0>this.width||0>this.height};
primitives.common.Rect.prototype.offset=function(a,b,c,d){switch(arguments.length){case 1:this.x-=a;this.y-=a;this.width+=2*a;this.height+=2*a;break;case 4:this.x-=a,this.y-=b,this.width=this.width+a+c,this.height=this.height+b+d}return this};primitives.common.Rect.prototype.translate=function(a,b){this.x+=a;this.y+=b;return this};primitives.common.Rect.prototype.invert=function(){var a=this.width,b=this.x;this.width=this.height;this.height=a;this.x=this.y;this.y=b;return this};
primitives.common.Rect.prototype.contains=function(a,b){switch(arguments.length){case 1:return this.x<=a.x&&a.x<=this.x+this.width&&this.y<=a.y&&a.y<=this.y+this.height;case 2:return this.x<=a&&a<=this.x+this.width&&this.y<=b&&b<=this.y+this.height;default:return!1}};
primitives.common.Rect.prototype.cropByRect=function(a){this.x<a.x&&(this.width-=a.x-this.x,this.x=a.x);this.right()>a.right()&&(this.width-=this.right()-a.right());this.y<a.y&&(this.height-=a.y-this.y,this.y=a.y);this.bottom()>a.bottom()&&(this.height-=this.bottom()-a.bottom());this.isEmpty()&&(this.height=this.width=this.y=this.x=null);return this};
primitives.common.Rect.prototype.overlaps=function(a){var b=!0;if(this.x+this.width<a.x||a.x+a.width<this.x||this.y+this.height<a.y||a.y+a.height<this.y)b=!1;return b};
primitives.common.Rect.prototype.addRect=function(a,b,c,d){var e,f;switch(arguments.length){case 1:a.isEmpty()||(this.isEmpty()?(this.x=a.x,this.y=a.y,this.width=a.width,this.height=a.height):(e=Math.max(this.right(),a.right()),f=Math.max(this.bottom(),a.bottom()),this.x=Math.min(this.x,a.x),this.y=Math.min(this.y,a.y),this.width=e-this.x,this.height=f-this.y));break;case 2:this.isEmpty()?(this.x=a,this.y=b,this.height=this.width=0):(e=Math.max(this.right(),a),f=Math.max(this.bottom(),b),this.x=Math.min(this.x,
a),this.y=Math.min(this.y,b),this.width=e-this.x,this.height=f-this.y);break;case 4:this.isEmpty()?(this.x=a,this.y=b,this.width=c,this.height=d):(e=Math.max(this.right(),a+c),f=Math.max(this.bottom(),b+d),this.x=Math.min(this.x,a),this.y=Math.min(this.y,b),this.width=e-this.x,this.height=f-this.y)}return this};primitives.common.Rect.prototype.getCSS=function(a){a=void 0!==a?a:"px";return{left:this.x+a,top:this.y+a,width:this.width+a,height:this.height+a}};
primitives.common.Rect.prototype.toString=function(a){var b,a=void 0!==a?a:"px";b=""+("left:"+this.x+a+";");b+="top:"+this.y+a+";";b+="width:"+this.width+a+";";return b+="height:"+this.height+a+";"};primitives.common.Size=function(a,b){this.height=this.width=0;switch(arguments.length){case 1:this.width=a.width;this.height=a.height;break;case 2:this.width=a,this.height=b}};primitives.common.Size.prototype.invert=function(){var a=this.width;this.width=this.height;this.height=a;return this};
primitives.common.Thickness=function(a,b,c,d){this.left=a;this.top=b;this.right=c;this.bottom=d};primitives.common.Thickness.prototype.isEmpty=function(){return 0===this.left&&0===this.top&&0===this.right&&0===this.bottom};primitives.common.Thickness.prototype.toString=function(a){a=void 0!==a?a:"px";return this.left+a+", "+this.top+a+", "+this.right+a+", "+this.bottom+a};
primitives.common.Graphics=function(a){this.m_widget=a;this.m_placeholders={};this.m_activePlaceholder=null;this.m_cache=new primitives.common.Cache;this.boxModel=jQuery.support.boxModel;this.graphicsType=null;this.hasGraphics=!1};
primitives.common.Graphics.prototype.clean=function(){var a,b,c,d;this.m_cache.clear();this.m_widget=this.m_cache=null;for(a in this.m_placeholders)if(this.m_placeholders.hasOwnProperty(a)){b=this.m_placeholders[a];for(c in b.layers)b.layers.hasOwnProperty(c)&&(d=b.layers[c],d.canvas.remove(),d.canvas=null);b.layers.length=0;b.activeLayer=null;b.size=null;b.rect=null;b.div=null}this.m_placeholders.length=0;this.m_activePlaceholder=null};
primitives.common.Graphics.prototype.resize=function(a,b,c){a=this.m_placeholders[a];null!=a&&this.resizePlaceholder(a,b,c)};primitives.common.Graphics.prototype.resizePlaceholder=function(a,b,c){var d;a.size=new primitives.common.Size(b,c);a.rect=new primitives.common.Rect(0,0,b,c);for(d in a.layers)a.layers.hasOwnProperty(d)&&(b=a.layers[d],-1!==b.name&&b.canvas.css({position:"absolute",width:"0px",height:"0px"}))};primitives.common.Graphics.prototype.begin=function(){this.m_cache.begin()};
primitives.common.Graphics.prototype.end=function(){this.m_cache.end()};primitives.common.Graphics.prototype.reset=function(a,b){var c="none",d=-1;switch(arguments.length){case 1:"string"===typeof a?c=a:d=a;break;case 2:c=a,d=b}this.m_cache.reset(c,d)};
primitives.common.Graphics.prototype.activate=function(a,b){switch(arguments.length){case 1:"string"===typeof a?(this._activatePlaceholder(a),this._activateLayer(-1)):(this._activatePlaceholder("none"),this._activateLayer(a));break;case 2:this._activatePlaceholder(a),this._activateLayer(b)}return this.m_activePlaceholder};
primitives.common.Graphics.prototype._activatePlaceholder=function(a){var b=this.m_placeholders[a],c;void 0===b&&(c="none"===a?this.m_widget.element:this.m_widget.element.find("."+a),b=new primitives.common.Placeholder(a),b.div=c,b.size=new primitives.common.Size(c.innerWidth(),c.innerHeight()),b.rect=new primitives.common.Rect(0,0,b.size.width,b.size.height),this.m_placeholders[a]=b);this.m_activePlaceholder=b};
primitives.common.Graphics.prototype._activateLayer=function(a){var b=this.m_activePlaceholder.layers[a],c,d,e,f;if(void 0===b){c=this.m_activePlaceholder;if(-1===a)b=new primitives.common.Layer(a),b.canvas=c.div;else{d=jQuery("<div></div>");d.addClass("Layer"+a);new primitives.common.Rect(c.rect);d.css({position:"absolute",width:"0px",height:"0px"});e=null;for(f in c.layers)c.layers.hasOwnProperty(f)&&(b=c.layers[f],b.name<a&&(e=null!==e?Math.max(e,b.name):b.name));b=new primitives.common.Layer(a);
b.canvas=d;null===e?c.div.prepend(b.canvas[0]):b.canvas.insertAfter(c.layers[e].canvas)}c.layers[a]=b}this.m_activePlaceholder.activeLayer=b};
primitives.common.Graphics.prototype.text=function(a,b,c,d,e,f,g,h,i){var j=this.m_activePlaceholder,g={position:"absolute",padding:0,margin:0,"text-align":this._getTextAlign(g),"font-size":i["font-size"],"font-family":i["font-family"],"font-weight":i["font-weight"],"font-style":i["font-style"],color:i["font-color"]},i="";switch(f){case 0:case 3:g.left=a;g.top=b;g.width=c;g.height=d;break;case 1:g.left=a+Math.round(c/2-d/2);g.top=b+Math.round(d/2-c/2);g.width=d;g.height=c;i="rotate(-90deg)";break;
case 2:g.left=a+Math.round(c/2-d/2),g.top=b+Math.round(d/2-c/2),g.width=d,g.height=c,i="rotate(90deg)"}g["-webkit-transform-origin"]="center center";g["-moz-transform-origin"]="center center";g["-o-transform-origin"]="center center";g["-ms-transform-origin"]="center center";g["-webkit-transform"]=i;g["-moz-transform"]=i;g["-o-transform"]=i;g["-ms-transform"]=i;g.transform=i;g["max-width"]=g.width;g["max-height"]=g.height;e=e.replace(RegExp("\n","g"),"<br/>");switch(h){case 0:a=this.m_cache.get(j.name,
j.activeLayer.name,"text");null===a?(a=jQuery("<div></div>"),a.css(g),a.html(e),j.activeLayer.canvas.append(a),this.m_cache.put(j.name,j.activeLayer.name,"text",a)):(a.css(g),a.html(e));break;default:g["border-collapse"]="collapse",b={"vertical-align":this._getVerticalAlignment(h),padding:0},a=this.m_cache.get(j.name,j.activeLayer.name,"textintable"),null===a?(a=jQuery("<table><tbody><tr><td></td></tr></tbody></table>"),primitives.common.css(a,g),a.find("td").css(b).html(e),j.activeLayer.canvas.append(a),
this.m_cache.put(j.name,j.activeLayer.name,"textintable",a)):(primitives.common.css(a,g),a.find("td").css(b).html(e))}};primitives.common.Graphics.prototype._getTextAlign=function(a){var b=null;switch(a){case 0:b="center";break;case 1:b="left";break;case 2:b="right"}return b};primitives.common.Graphics.prototype._getVerticalAlignment=function(a){var b=null;switch(a){case 1:b="middle";break;case 0:b="top";break;case 2:b="bottom"}return b};
primitives.common.Graphics.prototype.polyline=function(a,b){var c=null,d=null,e,f;for(e=0;e<a.length;e+=1)switch(f=a[e],f.segmentType){case 1:c=Math.round(f.x)+0.5;d=Math.round(f.y)+0.5;break;case 0:this.rightAngleLine(c,d,Math.round(f.x)+0.5,Math.round(f.y)+0.5,b);break;case 4:this.dot(f.x,f.y,f.radius,b)}};
primitives.common.Graphics.prototype.dot=function(a,b,c,d){var e=this.m_activePlaceholder,f=this.m_cache.get(e.name,e.activeLayer.name,"dot"),a={position:"absolute",width:2*c,top:b-c+0.5,left:a-c+0.5,padding:0,margin:0,"line-height":"0px",overflow:"hidden",height:2*c,background:d.fillColor,"-moz-border-radius":c,"-webkit-border-radius":c,"-khtml-border-radius":c,"border-radius":c,"font-size":"0px","border-style":"None","border-width":"0px"};null===f?(f=jQuery("<div></div>"),primitives.common.css(f,
a),e.activeLayer.canvas.append(f),this.m_cache.put(e.name,e.activeLayer.name,"dot",f)):primitives.common.css(f,a)};
primitives.common.Graphics.prototype.rightAngleLine=function(a,b,c,d,e){var f=this.m_activePlaceholder,g=Math.abs(d-b)>Math.abs(c-a),h=e.lineWidth,e={position:"absolute",top:Math.round(Math.min(b,d)-(g?0:h/2)),left:Math.round(Math.min(a,c)-(g?h/2:0)),padding:0,margin:0,opacity:0.5,"line-height":"0px",overflow:"hidden",background:e.borderColor,"font-size":"0px"};g?(e.width=h,e.height=Math.abs(Math.round(d-b))):(e.width=Math.abs(Math.round(c-a)),e.height=h);a=this.m_cache.get(f.name,f.activeLayer.name,
"rect");null===a?(a=jQuery("<div></div>"),primitives.common.css(a,e),f.activeLayer.canvas.append(a),this.m_cache.put(f.name,f.activeLayer.name,"rect",a)):primitives.common.css(a,e)};
primitives.common.Graphics.prototype.template=function(a,b,c,d,e,f,g,h,i,j,k,l,m){var c=this.m_activePlaceholder,d="template"+(null!==j)?j:primitives.common.hashCode(i),p=0,j=this.m_cache.get(c.name,c.activeLayer.name,d);null!==m&&void 0!==m["border-width"]&&(p=this.boxModel?this.getPxSize(m["border-width"]):0);a={width:g-p+"px",height:h-p+"px",top:b+f+"px",left:a+e+"px"};jQuery.extend(a,m);null===l&&(l=new primitives.common.RenderEventArgs);null===j?(j=jQuery(i),jQuery.extend(a,{position:"absolute",
overflow:"hidden",padding:"0px",margin:"0px"},m),primitives.common.css(j,a),l.element=j,l.renderingMode=0,null!==k&&this.m_widget._trigger(k,null,l),c.activeLayer.canvas.append(j),this.m_cache.put(c.name,c.activeLayer.name,d,j)):(l.element=j,l.renderingMode=1,primitives.common.css(j,a),null!==k&&this.m_widget._trigger(k,null,l));return j};
primitives.common.Graphics.prototype.getPxSize=function(a,b){var c=a;"string"===typeof a&&(c=0<a.indexOf("pt")?96*parseInt(a,10)/72:0<a.indexOf("%")?parseFloat(a)/100*b:parseInt(a,10));return c};primitives.common.Cache=function(){this.threshold=20;this.m_visible={};this.m_invisible={}};
primitives.common.Cache.prototype.begin=function(){var a,b,c,d;for(a in this.m_visible)if(this.m_visible.hasOwnProperty(a))for(b in this.m_visible[a])if(this.m_visible[a].hasOwnProperty(b)){for(c=this.m_visible[a][b].length-1;0<=c;c-=1)d=this.m_visible[a][b][c],d.css({visibility:"hidden"}),this.m_invisible[a][b].push(d);this.m_visible[a][b].length=0}};
primitives.common.Cache.prototype.end=function(){var a,b,c;for(a in this.m_visible)if(this.m_visible.hasOwnProperty(a))for(b in this.m_visible[a])if(this.m_visible[a].hasOwnProperty(b)&&this.m_invisible[a][b].length>this.threshold)for(;void 0!==(c=this.m_invisible[a][b].pop());)c.remove()};
primitives.common.Cache.prototype.reset=function(a,b){var a=a+"-"+b,c=null,d,e;for(d in this.m_visible[a])if(this.m_visible[a].hasOwnProperty(d)){for(e=this.m_visible[a][d].length-1;0<=e;e-=1)c=this.m_visible[a][d][e],this.m_invisible[a][d].push(c),c.css({visibility:"hidden"});this.m_visible[a][d].length=0}};
primitives.common.Cache.prototype.clear=function(){var a,b,c;for(a in this.m_visible)if(this.m_visible.hasOwnProperty(a))for(b in this.m_visible[a])if(this.m_visible[a].hasOwnProperty(b)){for(;void 0!==(c=this.m_visible[a][b].pop());)c.remove();for(;void 0!==(c=this.m_invisible[a][b].pop());)c.remove()}};
primitives.common.Cache.prototype.get=function(a,b,c){a=a+"-"+b;b=null;void 0===this.m_visible[a]&&(this.m_visible[a]={},this.m_invisible[a]={});void 0===this.m_visible[a][c]&&(this.m_visible[a][c]=[],this.m_invisible[a][c]=[]);b=this.m_invisible[a][c].pop()||null;null!==b&&(this.m_visible[a][c].push(b),b.css({visibility:"inherit"}));return b};primitives.common.Cache.prototype.put=function(a,b,c,d){this.m_visible[a+"-"+b][c].push(d)};
primitives.common.CanvasGraphics=function(a){this.parent=primitives.common.Graphics.prototype;this.parent.constructor.apply(this,arguments);this.graphicsType=1;this.m_maximum=6E3};primitives.common.CanvasGraphics.prototype=new primitives.common.Graphics;
primitives.common.CanvasGraphics.prototype.clean=function(){var a,b,c,d;for(a in this.m_placeholders)if(this.m_placeholders.hasOwnProperty(a))for(c in b=this.m_placeholders[a],b.layers)b.layers.hasOwnProperty(c)&&(d=b.layers[c],null!==d.canvascanvas&&(d.canvascanvas.remove(),d.canvascanvas=null));this.parent.clean.apply(this,arguments)};
primitives.common.CanvasGraphics.prototype._activatePlaceholder=function(a){var b,c,d;this.parent._activatePlaceholder.apply(this,arguments);b=this.m_activePlaceholder;c=b.size.width;d=b.size.height;b.hasGraphics=c>this.m_maximum||d>this.m_maximum?!1:!0};
primitives.common.CanvasGraphics.prototype.resizePlaceholder=function(a,b,c){var d,e;this.parent.resizePlaceholder.apply(this,arguments);for(d in a.layers)a.layers.hasOwnProperty(d)&&(e=a.layers[d],null!==e.canvascanvas&&(e.canvascanvas.css({position:"absolute",width:b+"px",height:c+"px"}),e.canvascanvas.attr({width:b+"px",height:c+"px"})))};
primitives.common.CanvasGraphics.prototype.begin=function(){var a,b,c,d,e,f;this.parent.begin.apply(this);for(a in this.m_placeholders)if(this.m_placeholders.hasOwnProperty(a))for(c in b=this.m_placeholders[a],e=b.size.width,f=b.size.height,b.layers)b.layers.hasOwnProperty(c)&&(d=b.layers[c],null!==d.canvascanvas&&d.canvascontext.clearRect(0,0,e,f))};
primitives.common.Graphics.prototype._getContext=function(a,b){var c=a.size.width,d=a.size.height;null===b.canvascanvas&&(b.canvascanvas=jQuery("<canvas></canvas>"),b.canvascanvas.attr({width:c+"px",height:d+"px"}),a.activeLayer.canvas.prepend(b.canvascanvas),b.canvascontext=b.canvascanvas[0].getContext("2d"));return b.canvascontext};
primitives.common.CanvasGraphics.prototype.reset=function(a,b){var c="none",d=-1,e,f;switch(arguments.length){case 1:"string"===typeof a?c=a:d=a;break;case 2:c=a,d=b}this.parent.reset.apply(this,arguments);e=this.m_placeholders[c];void 0!==e&&(c=e.size.width,f=e.size.height,d=e.layers[d],void 0!==d&&null!==d.canvascanvas&&d.canvascontext.clearRect(0,0,c,f))};
primitives.common.CanvasGraphics.prototype.polyline=function(a,b){var c=this.m_activePlaceholder,d,e;if(c.hasGraphics){d=c.activeLayer;c=this._getContext(c,d);c.save();void 0!==b.lineWidth&&void 0!==b.borderColor?(c.strokeStyle=b.borderColor,c.lineWidth=b.lineWidth):(c.lineWidth=0,c.strokeStyle="Transparent");c.beginPath();for(d=0;d<a.length;d+=1)switch(e=a[d],e.segmentType){case 1:c.moveTo(Math.round(e.x)+0.5,Math.round(e.y)+0.5);break;case 0:c.lineTo(Math.round(e.x)+0.5,Math.round(e.y)+0.5);break;
case 4:c.moveTo(Math.round(e.x)+0.5,Math.round(e.y)+0.5);c.arc(Math.round(e.x)+0.5,Math.round(e.y)+0.5,Math.round(e.radius),0,2*Math.PI,!1);break;case 2:c.quadraticCurveTo(Math.round(e.cpX)+0.5,Math.round(e.cpY)+0.5,Math.round(e.x)+0.5,Math.round(e.y)+0.5);break;case 3:c.bezierCurveTo(Math.round(e.cpX1)+0.5,Math.round(e.cpY1)+0.5,Math.round(e.cpX2)+0.5,Math.round(e.cpY2)+0.5,Math.round(e.x)+0.5,Math.round(e.y)+0.5)}void 0!==b.lineWidth&&c.stroke();void 0!==b.fillColor&&(c.fillStyle=b.fillColor,c.globalAlpha=
b.opacity,c.fill());c.restore()}else this.parent.polyline.apply(this,arguments)};primitives.common.Element=function(a,b){this.name=this.ns=null;this.attr={};this.style={};this.children=[];switch(arguments.length){case 1:this.name=a;break;case 2:this.ns=a,this.name=b}};primitives.common.Element.prototype.setAttribute=function(a,b){this.attr[a]=b};primitives.common.Element.prototype.appendChild=function(a){this.children[this.children.length]=a};
primitives.common.Element.prototype.create=function(a){var b=null,c,d,b=null!==this.ns?document.createElementNS(this.ns,this.name):document.createElement(this.name);for(c in this.attr)this.attr.hasOwnProperty(c)&&(void 0!==a?b[c]=this.attr[c]:b.setAttribute(c,this.attr[c]));for(c in this.style)this.style.hasOwnProperty(c)&&(b.style[c]=this.style[c]);for(d=0;d<this.children.length;d+=1)c=this.children[d],"string"===typeof c?b.appendChild(document.createTextNode(c)):b.appendChild(c.create(a));return b};
primitives.common.Element.prototype.update=function(a,b){var c,d,e;for(c in this.style)this.style.hasOwnProperty(c)&&(d=this.style[c],a.style[c]!==d&&(a.style[c]=d));for(c in this.attr)this.attr.hasOwnProperty(c)&&(d=this.attr[c],void 0!==b?a[c]!==d&&(a[c]=d):a.getAttribute(c)!==d&&a.setAttribute(c,d));c=this.children.length;for(d=0;d<c;d+=1)e=this.children[d],"string"===typeof e?a.innerHtml!==e&&(a.innerHtml=e):this.children[d].update(a.children[d],b)};
primitives.common.Layer=function(a){this.name=a;this.svgcanvas=this.canvascanvas=this.canvas=null};primitives.common.Placeholder=function(a){this.name=a;this.layers={};this.div=this.rect=this.size=this.activeLayer=null;this.hasGraphics=!0};primitives.common.SvgGraphics=function(a){this.parent=primitives.common.Graphics.prototype;this.parent.constructor.apply(this,arguments);this._svgxmlns="http://www.w3.org/2000/svg";this.graphicsType=0;this.hasGraphics=!0};
primitives.common.SvgGraphics.prototype=new primitives.common.Graphics;primitives.common.SvgGraphics.prototype.clean=function(){var a,b,c,d;for(a in this.m_placeholders)if(this.m_placeholders.hasOwnProperty(a))for(c in b=this.m_placeholders[a],b.layers)b.layers.hasOwnProperty(c)&&(d=b.layers[c],null!==d.svgcanvas&&(d.svgcanvas.remove(),d.svgcanvas=null));this.parent.clean.apply(this,arguments)};
primitives.common.SvgGraphics.prototype.resizePlaceholder=function(a,b,c){var d,e,f;this.parent.resizePlaceholder.apply(this,arguments);for(d in a.layers)a.layers.hasOwnProperty(d)&&(e=a.layers[d],null!==e.svgcanvas&&(f={position:"absolute",width:b+"px",height:c+"px"},e.svgcanvas.css(f)))};
primitives.common.SvgGraphics.prototype._getCanvas=function(){var a=this.m_activePlaceholder,b=a.activeLayer,c=a.rect;null===b.svgcanvas&&(b.svgcanvas=jQuery('<svg version = "1.1"></svg>'),b.svgcanvas.attr({viewBox:c.x+" "+c.y+" "+c.width+" "+c.height}),b.svgcanvas.css({width:c.width+"px",height:c.height+"px"}),a.activeLayer.canvas.prepend(b.svgcanvas));return b.svgcanvas};
primitives.common.SvgGraphics.prototype.polyline=function(a,b){var c=this.m_activePlaceholder,d,e,f,g;d=new primitives.common.Element(this._svgxmlns,"path");void 0!==b.fillColor?(d.setAttribute("fill",b.fillColor),d.setAttribute("fill-opacity",b.opacity)):d.setAttribute("fill-opacity",0);void 0!==b.lineWidth&&void 0!==b.borderColor?(d.setAttribute("stroke",b.borderColor),d.setAttribute("stroke-width",b.lineWidth)):(d.setAttribute("stroke","transparent"),d.setAttribute("stroke-width",0));e="";for(f=
0;f<a.length;f+=1)switch(g=a[f],g.segmentType){case 1:e+="M"+(Math.round(g.x)+0.5)+" "+(Math.round(g.y)+0.5);break;case 0:e+="L"+(Math.round(g.x)+0.5)+" "+(Math.round(g.y)+0.5);break;case 2:e+="Q"+(Math.round(g.cpX)+0.5)+" "+(Math.round(g.cpY)+0.5)+" "+(Math.round(g.x)+0.5)+" "+(Math.round(g.y)+0.5);break;case 4:e+="M"+(Math.round(g.x-g.radius)+0.5)+" "+(Math.round(g.y)+0.5);e+="A"+g.radius+" "+g.radius+" 0 1 0 "+(Math.round(g.x+g.radius)+0.5)+" "+(Math.round(g.y)+0.5);e+="A"+g.radius+" "+g.radius+
" 0 1 0 "+(Math.round(g.x-g.radius)+0.5)+" "+(Math.round(g.y)+0.5);break;case 3:e+="C"+(Math.round(g.cpX1)+0.5)+" "+(Math.round(g.cpY1)+0.5)+" "+(Math.round(g.cpX2)+0.5)+" "+(Math.round(g.cpY2)+0.5)+" "+(Math.round(g.x)+0.5)+" "+(Math.round(g.y)+0.5)}d.setAttribute("d",e);e=this.m_cache.get(c.name,c.activeLayer.name,"path");null===e?(e=jQuery(d.create()),d=this._getCanvas(),d.append(e),this.m_cache.put(c.name,c.activeLayer.name,"path",e)):d.update(e[0])};
primitives.common.Transform=function(){this.invertVertically=this.invertHorizontally=this.invertArea=!1;this.size=null};primitives.common.Transform.prototype.transformPointBack=function(a,b,c,d){var e;this.invertHorizontally&&(a=this.size.width-a);this.invertVertically&&(b=this.size.height-b);this.invertArea&&(e=a,a=b,b=e);d.call(c,a,b)};
primitives.common.Transform.prototype.transformPoint=function(a,b,c,d){var e;this.invertArea&&(e=a,a=b,b=e);this.invertHorizontally&&(a=this.size.width-a);this.invertVertically&&(b=this.size.height-b);d.call(c,a,b)};primitives.common.Transform.prototype.transformPoints=function(a,b,c,d,e,f){var g;this.invertArea&&(g=a,a=b,b=g,g=c,c=d,d=g);this.invertHorizontally&&(a=this.size.width-a,c=this.size.width-c);this.invertVertically&&(b=this.size.height-b,d=this.size.height-d);f.call(e,a,b,c,d)};
primitives.common.Transform.prototype.transform3Points=function(a,b,c,d,e,f,g,h){var i;this.invertArea&&(i=a,a=b,b=i,i=c,c=d,d=i,i=e,e=f,f=i);this.invertHorizontally&&(a=this.size.width-a,c=this.size.width-c,e=this.size.width-e);this.invertVertically&&(b=this.size.height-b,d=this.size.height-d,f=this.size.height-f);h.call(g,a,b,c,d,e,f)};
primitives.common.Transform.prototype.transformRect=function(a,b,c,d,e,f){var g;this.invertArea&&(g=a,a=b,b=g,g=c,c=d,d=g);this.invertHorizontally&&(a=this.size.width-a-c);this.invertVertically&&(b=this.size.height-b-d);f.call(e,a,b,c,d)};
primitives.common.VmlGraphics=function(a){var b,c,d;this.parent=primitives.common.Graphics.prototype;this.parent.constructor.apply(this,arguments);this.prefix="rvml";this.ie8mode=document.documentMode&&8<=document.documentMode;try{eval("document.namespaces")}catch(e){}document.namespaces[this.prefix]||document.namespaces.add(this.prefix,"urn:schemas-microsoft-com:vml");if(!primitives.common.VmlGraphics.prototype.vmlStyle){b=primitives.common.VmlGraphics.prototype.vmlStyle=document.createStyleSheet();
c=[" *","fill","shape","path","textpath"];for(d=0;d<c.length;d+=1)b.addRule(this.prefix+"\\:"+c[d],"behavior:url(#default#VML); position:absolute;")}this.graphicsType=2;this.hasGraphics=!0};primitives.common.VmlGraphics.prototype=new primitives.common.Graphics;
primitives.common.VmlGraphics.prototype.text=function(a,b,c,d,e,f,g,h,i){var j,k,l;switch(f){case 0:case 3:this.parent.text.call(this,a,b,c,d,e,f,g,h,i);break;default:j=this.m_activePlaceholder;f=1===f;a=new primitives.common.Rect(a,b,c,d);d=new primitives.common.Rect(0,0,10*c,10*d);c=new primitives.common.Element(this.prefix+":shape");c.setAttribute("CoordSize",d.width+","+d.height);c.setAttribute("filled",!0);c.setAttribute("stroked",!1);c.setAttribute("fillcolor",i["font-color"]);c.style.top=a.y+
"px";c.style.left=a.x+"px";c.style.width=a.width+"px";c.style.height=a.height+"px";c.style["font-family"]=i["font-family"];a=new primitives.common.Element(this.prefix+":path");a.setAttribute("TextPathOk",!0);b=16*Math.floor(this.getPxSize(i["font-size"]))*Math.max(e.split("\n").length-1,1);l=k=null;if(f)switch(h){case 0:k=new primitives.common.Point(d.x+b/2,d.bottom());l=new primitives.common.Point(d.x+b/2,d.y);break;case 1:k=new primitives.common.Point(d.horizontalCenter(),d.bottom());l=new primitives.common.Point(d.horizontalCenter(),
d.y);break;case 2:k=new primitives.common.Point(d.right()-b/2,d.bottom()),l=new primitives.common.Point(d.right()-b/2,d.y)}else switch(h){case 0:k=new primitives.common.Point(d.right()-b/2,d.y);l=new primitives.common.Point(d.right()-b/2,d.bottom());break;case 1:k=new primitives.common.Point(d.horizontalCenter(),d.y);l=new primitives.common.Point(d.horizontalCenter(),d.bottom());break;case 2:k=new primitives.common.Point(d.x+b/2,d.y),l=new primitives.common.Point(d.x+b/2,d.bottom())}a.setAttribute("v",
" m"+k.x+","+k.y+" l"+l.x+","+l.y+" e");h=new primitives.common.Element(this.prefix+":textpath");h.setAttribute("on",!0);h.setAttribute("string",e);h.style.trim=!1;h.style["v-text-align"]=this._getTextAlign(g);h.style.font="normal normal normal "+i["font-size"]+"pt "+i["font-family"];c.appendChild(a);c.appendChild(h);e=this.m_cache.get(j.name,j.activeLayer.name,"vmltext");null===e?(e=jQuery(c.create(this.ie8mode)),j.activeLayer.canvas.append(e),this.m_cache.put(j.name,j.activeLayer.name,"vmltext",
e)):c.update(e[0],this.ie8mode)}};
primitives.common.VmlGraphics.prototype.polyline=function(a,b){var c=this.m_activePlaceholder,d=new primitives.common.Rect(c.rect),e=new primitives.common.Rect(0,0,10*d.width,10*d.height),f=new primitives.common.Element(this.prefix+":shape"),g,h,i,j,k;void 0!==b.borderColor&&void 0!==b.lineWidth?(f.setAttribute("strokecolor",b.borderColor),f.setAttribute("strokeweight",b.lineWidth),f.setAttribute("stroked",!0)):f.setAttribute("stroked",!1);f.setAttribute("CoordSize",e.width+","+e.height);f.style.top=
d.y+"px";f.style.left=d.x+"px";f.style.width=d.width+"px";f.style.height=d.height+"px";d="";for(e=0;e<a.length;e+=1)switch(g=a[e],g.segmentType){case 1:d+=" m"+10*Math.round(g.x)+","+10*Math.round(g.y);break;case 0:d+=" l"+10*Math.round(g.x)+","+10*Math.round(g.y);break;case 4:h=Math.round(g.x-g.radius);i=Math.round(g.y-g.radius);j=Math.round(g.x+g.radius);g=Math.round(g.y+g.radius);h>j&&(k=h,h=j,j=k);i>g&&(k=i,i=g,g=k);h=10*h+5;i=10*i+5;j=10*j-5;g=10*g-5;d+=" m"+h+","+i;d+=" l"+j+","+i;d+=" l"+j+
","+g;d+=" l"+h+","+g;d+=" l"+h+","+i;break;case 2:d+=" qb"+10*Math.round(g.cpX)+","+10*Math.round(g.cpY)+" l"+10*Math.round(g.x)+","+10*Math.round(g.y);break;case 3:d+=" c"+10*Math.round(g.cpX1)+","+10*Math.round(g.cpY1)+","+10*Math.round(g.cpX2)+","+10*Math.round(g.cpY2)+","+10*Math.round(g.x)+","+10*Math.round(g.y)}d+=" e";e=new primitives.common.Element(this.prefix+":path");e.setAttribute("v",d);f.appendChild(e);null!==b.fillColor?(f.setAttribute("filled",!0),d=new primitives.common.Element(this.prefix+
":fill"),d.setAttribute("opacity",b.opacity),d.setAttribute("color",b.fillColor),f.appendChild(d)):f.setAttribute("filled",!1);d=this.m_cache.get(c.name,c.activeLayer.name,"shapepath");null===d?(d=jQuery(f.create(this.ie8mode)),c.activeLayer.canvas.append(d),this.m_cache.put(c.name,c.activeLayer.name,"shapepath",d)):f.update(d[0],this.ie8mode)};
primitives.text.Config=function(){this.classPrefix="bptext";this.graphicsType=0;this.actualGraphicsType=null;this.orientation=0;this.text="";this.verticalAlignment=1;this.horizontalAlignment=0;this.fontSize="16px";this.fontFamily="Arial";this.color="#000000";this.fontStyle=this.fontWeight="normal"};primitives.text.Controller=function(){this.widgetEventPrefix="bptext";this.options=new primitives.text.Config;this.m_graphics=this.m_panelSize=this.m_placeholder=null};
primitives.text.Controller.prototype._create=function(){this.element.addClass("ui-widget");this._createLayout();this._redraw()};primitives.text.Controller.prototype.destroy=function(){this._cleanLayout()};
primitives.text.Controller.prototype._createLayout=function(){this.m_panelSize=new primitives.common.Rect(0,0,this.element.outerWidth(),this.element.outerHeight());this.m_placeholder=jQuery("<div></div>");this.m_placeholder.css({position:"relative",overflow:"hidden",top:"0px",left:"0px",padding:"0px",margin:"0px"});this.m_placeholder.css(this.m_panelSize.getCSS());this.m_placeholder.addClass("placeholder");this.m_placeholder.addClass(this.widgetEventPrefix);this.element.append(this.m_placeholder);
this.m_graphics=primitives.common.createGraphics(this.options.graphicsType,this);this.options.actualGraphicsType=this.m_graphics.graphicsType};primitives.text.Controller.prototype._cleanLayout=function(){null!==this.m_graphics&&this.m_graphics.clean();this.m_graphics=null;this.element.find("."+this.widgetEventPrefix).remove()};primitives.text.Controller.prototype._updateLayout=function(){this.m_panelSize=new primitives.common.Rect(0,0,this.element.innerWidth(),this.element.innerHeight());this.m_placeholder.css(this.m_panelSize.getCSS())};
primitives.text.Controller.prototype.update=function(a){a?(this._cleanLayout(),this._createLayout(),this._redraw()):(this._updateLayout(),this.m_graphics.resize("placeholder",this.m_panelSize.width,this.m_panelSize.height),this.m_graphics.begin(),this._redraw(),this.m_graphics.end())};
primitives.text.Controller.prototype._redraw=function(){var a=this.m_graphics.activate("placeholder");this.m_graphics.text(a.rect.x,a.rect.y,a.rect.width,a.rect.height,this.options.text,this.options.orientation,this.options.horizontalAlignment,this.options.verticalAlignment,{"font-size":this.options.fontSize,"font-family":this.options.fontFamily,"font-style":this.options.fontStyle,"font-weight":this.options.fontWeight,"font-color":this.options.color})};
primitives.text.Controller.prototype._setOption=function(a,b){jQuery.Widget.prototype._setOption.apply(this,arguments);switch(a){case "disabled":var c=jQuery([]);b?(c.filter(".ui-state-focus").blur(),c.removeClass("ui-state-hover"),c.propAttr("disabled",!0),this.element.addClass("ui-disabled")):(c.propAttr("disabled",!1),this.element.removeClass("ui-disabled"))}};(function(a){a.widget("ui.bpText",new primitives.text.Controller)})(jQuery);
primitives.callout.Config=function(){this.classPrefix="bpcallout";this.graphicsType=1;this.actualGraphicsType=null;this.pointerPlacement=0;this.snapPoint=this.position=null;this.cornerRadius="10%";this.offset=0;this.lineWidth=this.opacity=1;this.pointerWidth="10%";this.borderColor="#000000";this.fillColor="#d3d3d3"};
primitives.callout.Controller=function(){this.widgetEventPrefix="bpcallout";this.options=new primitives.callout.Config;this.m_shape=this.m_graphics=this.m_panelSize=this.m_placeholder=null};primitives.callout.Controller.prototype._create=function(){this.element.addClass("ui-widget");this._createLayout();this._redraw()};primitives.callout.Controller.prototype.destroy=function(){this._cleanLayout()};
primitives.callout.Controller.prototype._createLayout=function(){this.m_panelSize=new primitives.common.Rect(0,0,this.element.outerWidth(),this.element.outerHeight());this.m_placeholder=jQuery("<div></div>");this.m_placeholder.css({position:"relative",overflow:"hidden",top:"0px",left:"0px",padding:"0px",margin:"0px"});this.m_placeholder.css(this.m_panelSize.getCSS());this.m_placeholder.addClass("placeholder");this.m_placeholder.addClass(this.widgetEventPrefix);this.element.append(this.m_placeholder);
this.m_graphics=primitives.common.createGraphics(this.options.graphicsType,this);this.options.actualGraphicsType=this.m_graphics.graphicsType;this.m_shape=new primitives.common.Callout(this.m_graphics)};primitives.callout.Controller.prototype._cleanLayout=function(){null!==this.m_graphics&&this.m_graphics.clean();this.m_graphics=null;this.element.find("."+this.widgetEventPrefix).remove()};
primitives.callout.Controller.prototype._updateLayout=function(){this.m_panelSize=new primitives.common.Rect(0,0,this.element.innerWidth(),this.element.innerHeight());this.m_placeholder.css(this.m_panelSize.getCSS())};primitives.callout.Controller.prototype.update=function(a){a?(this._cleanLayout(),this._createLayout(),this._redraw()):(this._updateLayout(),this.m_graphics.resize("placeholder",this.m_panelSize.width,this.m_panelSize.height),this.m_graphics.begin(),this._redraw(),this.m_graphics.end())};
primitives.callout.Controller.prototype._redraw=function(){this.m_graphics.activate("placeholder");var a="pointerPlacement cornerRadius offset opacity lineWidth pointerWidth borderColor fillColor".split(" "),b,c;for(b=0;b<a.length;b+=1)c=a[b],this.m_shape[c]=this.options[c];this.m_shape.draw(this.options.snapPoint,this.options.position)};
primitives.callout.Controller.prototype._setOption=function(a,b){jQuery.Widget.prototype._setOption.apply(this,arguments);switch(a){case "disabled":var c=jQuery([]);b?(c.filter(".ui-state-focus").blur(),c.removeClass("ui-state-hover"),c.propAttr("disabled",!0),this.element.addClass("ui-disabled")):(c.propAttr("disabled",!1),this.element.removeClass("ui-disabled"))}};(function(a){a.widget("ui.bpCallout",new primitives.callout.Controller)})(jQuery);
primitives.orgdiagram.TemplateConfig=function(){this.name=null;this.itemSize=new primitives.common.Size(120,100);this.itemBorderWidth=1;this.itemTemplate=null;this.minimizedItemSize=new primitives.common.Size(4,4);this.highlightPadding=new primitives.common.Thickness(2,2,2,2);this.highlightBorderWidth=1;this.highlightTemplate=null;this.cursorPadding=new primitives.common.Thickness(3,3,3,3);this.cursorBorderWidth=2;this.cursorTemplate=null};
primitives.orgdiagram.ButtonConfig=function(a,b){this.name=a;this.icon=b;this.text=!1;this.label=null;this.size=new primitives.common.Size(16,16)};
primitives.orgdiagram.Config=function(a){this.name=void 0!==a?a:"OrgDiagram";this.classPrefix="orgdiagram";this.graphicsType=0;this.actualGraphicsType=null;this.pageFitMode=3;this.orientationType=primitives.orgdiagram.OrientationType.Top;this.verticalAlignment=1;this.connectorType=this.horizontalAlignment=0;this.emptyDiagramMessage="Diagram is empty.";this.cursorItem=this.highligtItem=this.rootItem=null;this.selectedItems=[];this.hasSelectorCheckbox=0;this.selectionPathMode=1;this.minimalVisibility=
2;this.templates=[];this.defaultTemplateName=null;this.hasButtons=0;this.buttons=[];this.onCursorRender=this.onHighlightRender=this.onItemRender=this.onMouseClick=this.onButtonClick=this.onSelectionChanged=this.onSelectionChanging=this.onCursorChanged=this.onCursorChanging=this.onHighlightChanged=this.onHighlightChanging=null;this.dotLevelShift=this.normalLevelShift=20;this.normalItemsInterval=this.lineLevelShift=10;this.dotItemsInterval=1;this.lineItemsInterval=2;this.cousinsIntervalMultiplier=5;
this.itemTitleFirstFontColor="#ffffff";this.itemTitleSecondFontColor="#000080";this.selectCheckBoxLabel="Selected";this.linesColor="#c0c0c0";this.linesWidth=1;this.showCallout=!0;this.defaultCalloutTemplateName=null;this.calloutfillColor="#000000";this.calloutBorderColor=null;this.calloutCornerRadius=this.calloutOffset=4;this.calloutPointerWidth="10%";this.calloutLineWidth=1;this.calloutOpacity=0.2;this.leavesPlacementType=this.childrenPlacementType=2;this.maximumColumnsInMatrix=6;this.buttonsPanelSize=
28;this.checkBoxPanelSize=this.groupTitlePanelSize=24;this.distance=3;this.minimumScale=0.5;this.maximumScale=1;this.showLabels=0;this.labelSize=new primitives.common.Size(80,24);this.labelOffset=1;this.labelOrientation=0;this.labelPlacement=1;this.labelFontSize="10px";this.labelFontFamily="Arial";this.labelColor="#000000";this.labelFontStyle=this.labelFontWeight="normal";this.enablePanning=!0};
primitives.orgdiagram.ItemConfig=function(a,b,c){this.image=this.description=this.title=null;this.itemTitleColor="#4169e1";this.groupTitle=null;this.groupTitleColor="#4169e1";this.isVisible=!0;this.childrenPlacementType=this.adviserPlacementType=this.itemType=this.hasButtons=this.hasSelectorCheckbox=0;this.items=[];this.templateName=null;this.showCallout=0;this.label=this.calloutTemplateName=null;this.showLabel=0;this.labelSize=null;this.labelOrientation=3;this.labelPlacement=0;switch(arguments.length){case 3:this.title=
a,this.description=b,this.image=c}};
primitives.orgdiagram.Controller=function(){this.widgetEventPrefix="orgdiagram";this.options=new primitives.orgdiagram.Config;this.transform=this.graphics=null;this._treeItems={};this._treeItemCounter=0;this._treeLevels=[];this._leftMargins={};this._rightMargins={};this._templates={};this._groupTitleTemplateHashCode=this._groupTitleTemplate=this._buttonsTemplateHashCode=this._buttonsTemplate=this._checkBoxTemplateHashCode=this._checkBoxTemplate=this._defaultTemplate=null;this._selectedTreeItems=[];
this.m_scrollPanel=this._highlightTreeItem=this._cursorTreeItem=null;this.m_scrollPanelRect=new primitives.common.Rect(0,0,0,0);this.m_placeholder=null;this.m_placeholderRect=new primitives.common.Rect(0,0,0,0);this.m_calloutShape=this.m_calloutPlaceholder=null;this.boxModel=jQuery.support.boxModel;this._cancelMouseClick=!1;this._itemsInterval=[];this._scale=null;this.scale=1};
primitives.orgdiagram.Controller.prototype._create=function(){this.element.addClass("ui-widget");this._createLayout();this._bind();this.transform=this.graphics=null;this._redraw()};primitives.orgdiagram.Controller.prototype.destroy=function(){this._unbind();this._clean();this._cleanLayout()};primitives.orgdiagram.Controller.prototype._clean=function(){null!==this.graphics&&this.graphics.clean();this.transform=this.graphics=null};
primitives.orgdiagram.Controller.prototype._cleanLayout=function(){this.options.enablePanning&&this._mouseDestroy();this.element.find("."+this.widgetEventPrefix).remove()};
primitives.orgdiagram.Controller.prototype._createLayout=function(){this.m_scrollPanelRect=new primitives.common.Rect(0,0,this.element.outerWidth(),this.element.outerHeight());this.m_placeholderRect=new primitives.common.Rect(this.m_scrollPanelRect);this.m_scrollPanel=jQuery("<div></div>");this.m_scrollPanel.css({position:"relative",overflow:"auto",top:"0px",left:"0px",padding:"0px",margin:"0px","-webkit-overflow-scrolling":"touch"});this.m_scrollPanel.addClass(this.widgetEventPrefix);this.m_scrollPanel.css(this.m_scrollPanelRect.getCSS());
this.m_placeholder=jQuery("<div></div>");this.m_placeholder.css({position:"absolute",overflow:"hidden",top:"0px",left:"0px"});this.m_placeholder.addClass("placeholder");this.m_placeholder.addClass(this.widgetEventPrefix);this.m_placeholder.css(this.m_placeholderRect.getCSS());this.m_scrollPanel.append(this.m_placeholder);this.m_calloutPlaceholder=jQuery("<div></div>");this.m_calloutPlaceholder.css({position:"absolute",overflow:"visible"});this.m_calloutPlaceholder.addClass("calloutplaceholder");this.m_calloutPlaceholder.addClass(this.widgetEventPrefix);
this.m_calloutPlaceholder.css({top:"0px",left:"0px",width:"0px",height:"0px"});this.m_placeholder.append(this.m_calloutPlaceholder);this.element.append(this.m_scrollPanel);this.options.enablePanning&&this._mouseInit(this.m_placeholder)};primitives.orgdiagram.Controller.prototype._updateLayout=function(){this.m_scrollPanelRect=new primitives.common.Rect(0,0,this.element.outerWidth(),this.element.outerHeight());this.m_scrollPanel.css(this.m_scrollPanelRect.getCSS())};
primitives.orgdiagram.Controller.prototype._bind=function(){var a=this;this.m_placeholder.mousemove(function(b){a._onMouseMove(b)}).click(function(b){a._onMouseClick(b)});"ontouchstart"in document.documentElement&&(this.m_scrollPanel[0].addEventListener("gesturestart",a.onGestureStartHandler=function(b){a.onGestureStart(b)},!1),this.m_scrollPanel[0].addEventListener("gesturechange",a.onGestureChangeHandler=function(b){a.onGestureChange(b)},!1));this.options.onDefaultTemplateRender=function(b,c){a._onDefaultTemplateRender(b,
c)};this.options.onCheckBoxTemplateRender=function(b,c){a._onCheckBoxTemplateRender(b,c)};this.options.onGroupTitleTemplateRender=function(b,c){a._onGroupTitleTemplateRender(b,c)};this.options.onButtonsTemplateRender=function(b,c){a._onButtonsTemplateRender(b,c)}};
primitives.orgdiagram.Controller.prototype._unbind=function(){this.m_placeholder.unbind("mousemove");this.m_placeholder.unbind("click");"ontouchstart"in document.documentElement&&(this.m_scrollPanel[0].removeEventListener("gesturestart",this.onGestureStartHandler,!1),this.m_scrollPanel[0].removeEventListener("mousewheel",this.onGestureChangeHandler,!1));this.options.onDefaultTemplateRender=null;this.options.onCheckBoxTemplateRender=null};
primitives.orgdiagram.Controller.prototype.update=function(a){switch(a){case 2:this._redrawHighlight();break;case 1:this._refresh();break;default:this._redraw()}};primitives.orgdiagram.Controller.prototype._mouseCapture=function(a){this._dragStartPosition=new primitives.common.Point(this.m_scrollPanel.scrollLeft()+a.pageX,this.m_scrollPanel.scrollTop()+a.pageY);return!0};
primitives.orgdiagram.Controller.prototype._mouseDrag=function(a){var b=new primitives.common.Point(a.pageX,a.pageY),a=-b.x+this._dragStartPosition.x,b=-b.y+this._dragStartPosition.y;this.m_scrollPanel.css("visibility","hidden");this.m_scrollPanel.scrollLeft(a).scrollTop(b);this.m_scrollPanel.css("visibility","inherit");return!1};primitives.orgdiagram.Controller.prototype._mouseStop=function(){this._cancelMouseClick=!0};
primitives.orgdiagram.Controller.prototype._onMouseMove=function(a){var b=this.m_placeholder.offset(),c=b.left,d=b.top,b=a.pageX-c,e=a.pageY-d,f;this._mouseStarted||(this._cancelMouseClick=!1,e=this._getTreeItemForMousePosition(b,e),"ontouchstart"in document.documentElement?this._highlightTreeItem=e:null!==e?e.itemConfig!==this.options.highlightItem&&(this._highlightTreeItem=e,f=new primitives.orgdiagram.EventArgs,f.oldContext=this.options.highlightItem,this.options.highlightItem=e.itemConfig,f.context=
this.options.highlightItem,f.parentItem=null!==this._highlightTreeItem.logicalParentId?this._treeItems[this._highlightTreeItem.logicalParentId].itemConfig:null,b=this.element.offset(),f.position=(new primitives.common.Rect(e.actualPosition)).translate(c,d).translate(-b.left,-b.top),this._trigger("onHighlightChanging",a,f),f.cancel||(this._refreshHighlight(),this._trigger("onHighlightChanged",a,f))):null!==this.options.highlightItem&&(this._highlightTreeItem=null,f=new primitives.orgdiagram.EventArgs,
f.oldContext=this.options.highlightItem,f.parentItem=null,this.options.highlightItem=null,f.context=this.options.highlightItem,this._trigger("onHighlightChanging",a,f),f.cancel||(this._refreshHighlight(),this._trigger("onHighlightChanged",a,f))))};
primitives.orgdiagram.Controller.prototype._onMouseClick=function(a){var b=this._highlightTreeItem,c,d;null!==b&&!this._cancelMouseClick&&(c=jQuery(a.target),c.hasClass(this.widgetEventPrefix+"button")||0<c.parent("."+this.widgetEventPrefix+"button").length?(c=c.hasClass(this.widgetEventPrefix+"button")?c:c.parent("."+this.widgetEventPrefix+"button"),d=c.data("buttonname"),c=new primitives.orgdiagram.EventArgs,c.context=b.itemConfig,c.parentItem=null!==b.logicalParentId?this._treeItems[b.logicalParentId].itemConfig:
null,c.name=d,this._trigger("onButtonClick",a,c)):"selectiontext"!==c.attr("name")&&("checkbox"===c.attr("name")?(c=new primitives.orgdiagram.EventArgs,c.context=b.itemConfig,c.parentItem=null!==b.logicalParentId?this._treeItems[b.logicalParentId].itemConfig:null,this._trigger("onSelectionChanging",a,c),d=primitives.common.indexOf(this.options.selectedItems,b.itemConfig),0<=d?this.options.selectedItems.splice(d,1):this.options.selectedItems.push(b.itemConfig),this._trigger("onSelectionChanged",a,
c)):(c=new primitives.orgdiagram.EventArgs,c.context=b.itemConfig,c.parentItem=null!==b.logicalParentId?this._treeItems[b.logicalParentId].itemConfig:null,this._trigger("onMouseClick",a,c),!c.cancel&&b.itemConfig!==this.options.cursorItem&&(c=new primitives.orgdiagram.EventArgs,c.oldContext=this.options.cursorItem,this.options.cursorItem=b.itemConfig,c.context=this.options.cursorItem,c.parentItem=null!==b.logicalParentId?this._treeItems[b.logicalParentId].itemConfig:null,this._trigger("onCursorChanging",
a,c),c.cancel||(this._refresh(),this._trigger("onCursorChanged",a,c))))));this._cancelMouseClick=!1};primitives.orgdiagram.Controller.prototype.onGestureStart=function(a){this._scale=this.scale;a.preventDefault()};primitives.orgdiagram.Controller.prototype.onGestureChange=function(a){var b=Math.round(10*this._scale*a.scale)/10;b>this.options.maximumScale?b=this.options.maximumScale:b<this.options.minimumScale&&(b=this.options.minimumScale);this.scale=b;this._refresh();a.preventDefault()};
primitives.orgdiagram.Controller.prototype._updateScale=function(){var a="scale("+this.scale+","+this.scale+")";this.m_placeholder.css({"transform-origin":"0 0",transform:a,"-ms-transform":a,"-webkit-transform":a,"-o-transform":a,"-moz-transform":a})};
primitives.orgdiagram.Controller.prototype._redraw=function(){this._clean();this.graphics=primitives.common.createGraphics(this.options.graphicsType,this);this.transform=new primitives.common.Transform;this.options.actualGraphicsType=this.graphics.graphicsType;this.m_calloutShape=new primitives.common.Callout(this.graphics);this._readTemplates();this._createCheckBoxTemplate();this._createButtonsTemplate();this._createGroupTitleTemplate();this._refresh()};
primitives.orgdiagram.Controller.prototype._refresh=function(){this._updateLayout();this.m_scrollPanel.css({display:"none","-webkit-overflow-scrolling":"auto"});this._updateScale();this._setItemsIntervals();this._readTreeItems();this._positionTreeItems();this.graphics.resize("placeholder",this.m_placeholderRect.width,this.m_placeholderRect.height);this.transform.size=new primitives.common.Size(this.m_placeholderRect.width,this.m_placeholderRect.height);this.graphics.begin();this._redrawTreeItems();
this._redrawConnectors();this._drawHighlight();this._hideHighlightAnnotation();this._drawCursor();this.graphics.end();this.m_scrollPanel.css({display:"block"});this._centerOnCursor();this.m_scrollPanel.css({"-webkit-overflow-scrolling":"touch"})};
primitives.orgdiagram.Controller.prototype._setItemsIntervals=function(){this._itemsInterval[1]=this.options.normalItemsInterval;this._itemsInterval[2]=this.options.dotItemsInterval;this._itemsInterval[3]=this.options.lineItemsInterval;this._itemsInterval[4]=this.options.lineItemsInterval};
primitives.orgdiagram.Controller.prototype._redrawHighlight=function(){var a,b;for(a in this._treeItems)this._treeItems.hasOwnProperty(a)&&(b=this._treeItems[a],b.itemConfig===this.options.highlightItem&&(this._highlightTreeItem=b));this._refreshHighlight()};primitives.orgdiagram.Controller.prototype._refreshHighlight=function(){this.graphics.reset("placeholder",2);this.graphics.reset("calloutplaceholder",7);this._drawHighlight();this._drawHighlightAnnotation()};
primitives.orgdiagram.Controller.prototype._drawHighlight=function(){var a,b,c,d;null!==this._highlightTreeItem&&(this.graphics.activate("placeholder",2),a=this._highlightTreeItem.actualPosition,b=new primitives.common.Rect(0,0,this._highlightTreeItem.actualSize.width,this._highlightTreeItem.actualSize.height),c=this._highlightTreeItem.template.highlightPadding,b.offset(c.left,c.top,c.right,c.bottom),d=new primitives.common.RenderEventArgs,d.context=this._highlightTreeItem.itemConfig,d.isCursor=this._highlightTreeItem.isCursor,
d.isSelected=this._highlightTreeItem.isSelected,d.templateName=this._highlightTreeItem.template.name,this.transform.transformRect(a.x,a.y,a.width,a.height,this,function(a,c,g,h){this.graphics.template(a,c,g,h,b.x,b.y,b.width,b.height,this._highlightTreeItem.template.highlightTemplate,this._highlightTreeItem.template.highlightTemplateHashCode,this._highlightTreeItem.template.highlightTemplateRenderName,d,{"border-width":this._highlightTreeItem.template.highlightBorderWidth})}))};
primitives.orgdiagram.Controller.prototype._drawCursor=function(){var a=this._cursorTreeItem,b,c,d,e;null!==a&&1==a.actualVisibility&&(this.graphics.activate("placeholder",5),b=a.actualPosition,c=new primitives.common.Rect(a.contentPosition),d=a.template.cursorPadding,c.offset(d.left,d.top,d.right,d.bottom),e=new primitives.common.RenderEventArgs,e.context=a.itemConfig,e.isCursor=a.isCursor,e.isSelected=a.isSelected,e.templateName=a.template.name,this.transform.transformRect(b.x,b.y,b.width,b.height,
this,function(b,d,h,i){this.graphics.template(b,d,h,i,c.x,c.y,c.width,c.height,a.template.cursorTemplate,a.template.cursorTemplateHashCode,a.template.cursorTemplateRenderName,e,{"border-width":a.template.cursorBorderWidth})}))};
primitives.orgdiagram.Controller.prototype._redrawTreeItems=function(){var a,b,c,d,e,f,g={},h,i,j,k;this.graphics.activate("placeholder",6);this._setTransform();i=0;for(j=this._treeLevels.length;i<j;i+=1)c=this._treeLevels[i],c.labels=[],c.labelsRect=null,c.hasFixedLabels=!1,c.showLabels=!0;for(f in this._treeItems)this._treeItems.hasOwnProperty(f)&&(a=this._treeItems[f],b=a.itemConfig,c=this._treeLevels[a.level],a.setActualPosition(c,this.options),this.transform.transformRect(a.actualPosition.x,
a.actualPosition.y,a.actualPosition.width,a.actualPosition.height,this,function(f,i,j,n){switch(a.actualVisibility){case 1:d=new primitives.common.RenderEventArgs;d.context=b;d.isCursor=a.isCursor;d.isSelected=a.isSelected;d.templateName=a.template.name;this.graphics.template(f,i,j,n,a.contentPosition.x,a.contentPosition.y,a.contentPosition.width,a.contentPosition.height,a.template.itemTemplate,a.template.itemTemplateHashCode,a.template.itemTemplateRenderName,d,{"border-width":a.template.itemBorderWidth});
a.hasGroupTitle&&this.graphics.template(f,i,j,n,2,a.contentPosition.y,this.options.groupTitlePanelSize-4,a.contentPosition.height,this._groupTitleTemplate,this._groupTitleTemplateHashCode,"onGroupTitleTemplateRender",a,null);a.hasSelectorCheckbox&&this.graphics.template(f,i,j,n,a.contentPosition.x,a.actualSize.height-(this.options.checkBoxPanelSize-4),a.contentPosition.width,this.options.checkBoxPanelSize-4,this._checkBoxTemplate,this._checkBoxTemplateHashCode,"onCheckBoxTemplateRender",a,null);a.hasButtons&&
this.graphics.template(f,i,j,n,a.actualSize.width-(this.options.buttonsPanelSize-4),a.contentPosition.y,this.options.buttonsPanelSize-4,Math.max(a.contentPosition.height,a.actualSize.height-a.contentPosition.y),this._buttonsTemplate,this._buttonsTemplateHashCode,"onButtonsTemplateRender",a,null);0==this.options.showLabels&&(k=new primitives.common.Label,k.text=b.title,k.position=new primitives.common.Rect(f,i,j,n),k.weight=1E4,k.labelType=primitives.common.LabelType.Dummy,c.labels.push(k));k=this._createLabel(f,
i,j,n,a);null!=k&&c.labels.push(k);break;case 2:e=b.itemTitleColor,null==e&&(e="#000080"),g.hasOwnProperty(e)||(g[e]=[]),h=g[e],h.push(new primitives.common.DotSegment(f+j/2,i+n/2,j/2)),k=this._createLabel(f,i,j,n,a),null!=k&&c.labels.push(k)}}));this.graphics.activate("placeholder",3);for(e in g)g.hasOwnProperty(e)&&(h=g[e],f={fillColor:e,opacity:1},this.graphics.polyline(h,f));this._redrawLabels()};
primitives.orgdiagram.Controller.prototype._redrawLabels=function(){var a,b,c,d,e,f,g,h;if(0==this.options.showLabels){g=0;for(h=this._treeLevels.length;g<h;g+=1){e=this._treeLevels[g];a=e.labels;d=0;for(f=a.length;d<f;d+=1)b=a[d],null==e.labelsRect?e.labelsRect=new primitives.common.Rect(b.position):e.labelsRect.addRect(b.position),e.hasFixedLabels=e.hasFixedLabels||b.labelType==primitives.common.LabelType.Fixed}for(g=this._treeLevels.length-1;0<g;g-=1)a=this._treeLevels[g-1],b=this._treeLevels[g],
null!=a.labelsRect&&null!=b.labelsRect&&a.labelsRect.overlaps(b.labelsRect)&&(b.showLabels=!1);g=0;for(h=this._treeLevels.length;g<h;g+=1)if(e=this._treeLevels[g],a=e.labels,e.showLabels){d=0;for(f=a.length;d<f;d+=1)if(b=a[d],b.isActive)for(e=d+1;e<f;e+=1)if(c=a[e],c.isActive)if(b.position.overlaps(c.position))if(b.weight>=c.weight)c.labelType==primitives.common.LabelType.Regular&&(c.isActive=!1);else{b.labelType==primitives.common.LabelType.Regular&&(b.isActive=!1);break}else break}}this.graphics.activate("placeholder",
4);c={"font-size":this.options.labelFontSize,"font-family":this.options.labelFontFamily,"font-style":this.options.labelFontStyle,"font-weight":this.options.labelFontWeight,"font-color":this.options.labelColor};g=0;for(h=this._treeLevels.length;g<h;g+=1)if(e=this._treeLevels[g],e.showLabels||e.hasFixedLabels){a=e.labels;d=0;for(f=a.length;d<f;d+=1)if(b=a[d],b.isActive)switch(b.labelType){case primitives.common.LabelType.Regular:case primitives.common.LabelType.Fixed:this.graphics.text(b.position.x,
b.position.y,b.position.width,b.position.height,b.text,b.labelOrientation,b.horizontalAlignmentType,b.verticalAlignmentType,c)}}};
primitives.orgdiagram.Controller.prototype._createLabel=function(a,b,c,d,e){var f,g,h=null,i=this.options.labelOffset,j;j=e.itemConfig;if(!primitives.common.isNullOrEmpty(j.label)){switch(j.showLabel){case 0:switch(this.options.showLabels){case 0:switch(e.actualVisibility){case 3:case 2:h=new primitives.common.Label,h.labelType=primitives.common.LabelType.Regular,h.weight=e.leftPadding+e.rightPadding}break;case 1:h=new primitives.common.Label,h.labelType=primitives.common.LabelType.Fixed,h.weight=
1E4}break;case 1:h=new primitives.common.Label,h.weight=1E4,h.labelType=primitives.common.LabelType.Fixed}if(null!=h){h.text=j.label;e=null!=j.labelSize?j.labelSize:this.options.labelSize;h.labelOrientation=3!=j.labelOrientation?j.labelOrientation:3!=this.options.labelOrientation?this.options.labelOrientation:0;j=0!=j.labelPlacement?j.labelPlacement:0!=this.options.labelPlacement?this.options.labelPlacement:1;switch(h.labelOrientation){case 0:f=e.width;g=e.height;break;case 1:case 2:g=e.width,f=e.height}switch(j){case 0:case 1:h.position=
new primitives.common.Rect(a+c/2-f/2,b-i-g,f,g);switch(h.labelOrientation){case 0:h.horizontalAlignmentType=0;h.verticalAlignmentType=2;break;case 1:h.horizontalAlignmentType=1;h.verticalAlignmentType=1;break;case 2:h.horizontalAlignmentType=2,h.verticalAlignmentType=1}break;case 2:h.position=new primitives.common.Rect(a+c+i,b-i-g,f,g);switch(h.labelOrientation){case 0:h.horizontalAlignmentType=1;h.verticalAlignmentType=2;break;case 1:h.horizontalAlignmentType=1;h.verticalAlignmentType=0;break;case 2:h.horizontalAlignmentType=
2,h.verticalAlignmentType=2}break;case 3:h.position=new primitives.common.Rect(a+c+i,b+d/2-g/2,f,g);switch(h.labelOrientation){case 0:h.horizontalAlignmentType=1;h.verticalAlignmentType=1;break;case 1:h.horizontalAlignmentType=0;h.verticalAlignmentType=0;break;case 2:h.horizontalAlignmentType=0,h.verticalAlignmentType=2}break;case 4:h.position=new primitives.common.Rect(a+c+i,b+d+i,f,g);switch(h.labelOrientation){case 0:h.horizontalAlignmentType=1;h.verticalAlignmentType=0;break;case 1:h.horizontalAlignmentType=
2;h.verticalAlignmentType=0;break;case 2:h.horizontalAlignmentType=1,h.verticalAlignmentType=2}break;case 5:h.position=new primitives.common.Rect(a+c/2-f/2,b+d+i,f,g);switch(h.labelOrientation){case 0:h.horizontalAlignmentType=0;h.verticalAlignmentType=0;break;case 1:h.horizontalAlignmentType=2;h.verticalAlignmentType=1;break;case 2:h.horizontalAlignmentType=1,h.verticalAlignmentType=1}break;case 6:h.position=new primitives.common.Rect(a-f-i,b+d+i,f,g);switch(h.labelOrientation){case 0:h.horizontalAlignmentType=
2;h.verticalAlignmentType=0;break;case 1:h.horizontalAlignmentType=2;h.verticalAlignmentType=2;break;case 2:h.horizontalAlignmentType=1,h.verticalAlignmentType=0}break;case 7:h.position=new primitives.common.Rect(a-f-i,b+d/2-g/2,f,g);switch(h.labelOrientation){case 0:h.horizontalAlignmentType=2;h.verticalAlignmentType=1;break;case 1:h.horizontalAlignmentType=0;h.verticalAlignmentType=2;break;case 2:h.horizontalAlignmentType=0,h.verticalAlignmentType=0}break;case 8:switch(h.position=new primitives.common.Rect(a-
f-i,b-i-g,f,g),h.labelOrientation){case 0:h.horizontalAlignmentType=2;h.verticalAlignmentType=2;break;case 1:h.horizontalAlignmentType=1;h.verticalAlignmentType=2;break;case 2:h.horizontalAlignmentType=2,h.verticalAlignmentType=0}}}}return h};
primitives.orgdiagram.Controller.prototype._setTransform=function(){switch(this.options.orientationType){case primitives.orgdiagram.OrientationType.Top:this.transform.invertArea=!1;this.transform.invertHorizontally=!1;this.transform.invertVertically=!1;break;case primitives.orgdiagram.OrientationType.Bottom:this.transform.invertArea=!1;this.transform.invertHorizontally=!1;this.transform.invertVertically=!0;break;case primitives.orgdiagram.OrientationType.Left:this.transform.invertArea=!0;this.transform.invertHorizontally=
!1;this.transform.invertVertically=!1;break;case primitives.orgdiagram.OrientationType.Right:this.transform.invertArea=!0,this.transform.invertHorizontally=!0,this.transform.invertVertically=!1}};
primitives.orgdiagram.Controller.prototype._redrawConnectors=function(){var a=this.graphics.activate("placeholder",1),b=this._visualRootItem,c,d;this._treeItems.hasOwnProperty(b)&&(c=this._treeItems[b],d=this._treeLevels[c.level],b=[],this._redrawConnector(a.hasGraphics,b,c,d),a={borderColor:this.options.linesColor,lineWidth:this.options.linesWidth},this.graphics.polyline(b,a))};
primitives.orgdiagram.Controller.prototype._redrawConnector=function(a,b,c,d){var e,f,g,h,i,j,k,l,m,p,n;if(0<c.visualChildren.length){e=4===c.actualVisibility&&c.id===this._visualRootItem;n=c.actualPosition.horizontalCenter();e||this.transform.transformPoints(n,c.actualPosition.bottom(),n,d.connectorShift,this,function(a,c,d,e){b.push(new primitives.common.MoveSegment(a,c));b.push(new primitives.common.LineSegment(d,e))});i=h=null;j=[];c=c.visualChildren;for(m=0;m<c.length;m+=1){k=this._treeItems[c[m]];
l=this._treeLevels[k.level];switch(k.connectorPlacement){case 7:f=this._treeItems[l.treeItems[k.levelPosition-1]];this.transform.transformPoints(k.actualPosition.x,k.actualPosition.verticalCenter(),f.actualPosition.right(),k.actualPosition.verticalCenter(),this,function(a,c,d,e){b.push(new primitives.common.MoveSegment(a,c));b.push(new primitives.common.LineSegment(d,e))});break;case 3:f=this._treeItems[l.treeItems[k.levelPosition+1]];this.transform.transformPoints(k.actualPosition.right(),k.actualPosition.verticalCenter(),
f.actualPosition.x,k.actualPosition.verticalCenter(),this,function(a,c,d,e){b.push(new primitives.common.MoveSegment(a,c));b.push(new primitives.common.LineSegment(d,e))});break;case 1:if(!e)switch(f=new primitives.common.Point(k.actualPosition.horizontalCenter(),d.connectorShift),g=new primitives.common.Point(k.actualPosition.horizontalCenter(),k.actualPosition.top()),p=a?k.actualVisibility:1,p){case 1:case 4:0<j.length&&(p=this._drawAngularConnectors(b,d.connectorShift,j,n,null==h,!1),null===h&&
(h=p));this.transform.transformPoints(f.x,f.y,g.x,g.y,this,function(a,c,d,e){b.push(new primitives.common.MoveSegment(a,c));b.push(new primitives.common.LineSegment(d,e))});null===h?h=f:i=f;break;case 2:case 3:switch(this.options.connectorType){case 1:case 2:j.push(g);break;case 0:this.transform.transformPoints(f.x,f.y,g.x,g.y,this,function(a,c,d,e){b.push(new primitives.common.MoveSegment(a,c));b.push(new primitives.common.LineSegment(d,e))}),null===h?h=f:i=f}}}this._redrawConnector(a,b,k,l)}e||
(0<j.length&&(i=this._drawAngularConnectors(b,d.connectorShift,j,n,null==h,!0)),null!==h&&null!==i&&(n<h.x?h.x=n:n>i.x&&(i.x=n),h!==i&&this.transform.transformPoints(h.x,h.y,i.x,i.y,this,function(a,c,d,e){b.push(new primitives.common.MoveSegment(a,c));b.push(new primitives.common.LineSegment(d,e))})))}};
primitives.orgdiagram.Controller.prototype._drawAngularConnectors=function(a,b,c,d,e,f){var g=null,h=c.length;if(0<h)if(d<c[0].x?(g=new primitives.common.Point(c[0].x,b),b=!1):d>c[h-1].x?(g=new primitives.common.Point(c[h-1].x,b),b=!1):(g=new primitives.common.Point(d,b),b=!0),e||f)for(e=0;e<h;e+=1)switch(this.transform.transformPoint(g.x,g.y,this,function(b,c){a.push(new primitives.common.MoveSegment(b,c))}),this.options.connectorType){case 1:this.transform.transformPoint(c[e].x,c[e].y,this,function(b,
c){a.push(new primitives.common.LineSegment(b,c))});break;case 2:f=new primitives.common.Rect(g,c[e]),b?g.x>f.x?this.transform.transform3Points(f.right(),f.verticalCenter(),f.x,f.verticalCenter(),f.x,f.bottom(),this,function(b,c,d,e,f,g){a.push(new primitives.common.CubicArcSegment(b,c,d,e,f,g))}):this.transform.transform3Points(f.x,f.verticalCenter(),f.right(),f.verticalCenter(),f.right(),f.bottom(),this,function(b,c,d,e,f,g){a.push(new primitives.common.CubicArcSegment(b,c,d,e,f,g))}):g.x>f.x?this.transform.transformPoints(f.x,
f.y,f.x,f.bottom(),this,function(b,c,d,e){a.push(new primitives.common.QuadraticArcSegment(b,c,d,e))}):this.transform.transformPoints(f.right(),f.y,f.right(),f.bottom(),this,function(b,c,d,e){a.push(new primitives.common.QuadraticArcSegment(b,c,d,e))})}else for(e=0;e<h;e+=1)this.transform.transformPoints(c[e].x,g.y,c[e].x,c[e].y,this,function(b,c,d,e){a.push(new primitives.common.MoveSegment(b,c));a.push(new primitives.common.LineSegment(d,e))});c.length=0;return g};
primitives.orgdiagram.Controller.prototype._centerOnCursor=function(){null!==this._cursorTreeItem&&(this.graphics.activate("placeholder",6),this.transform.transformPoint(this._cursorTreeItem.actualPosition.horizontalCenter()*this.scale,this._cursorTreeItem.actualPosition.verticalCenter()*this.scale,this,function(a,b){this.m_scrollPanel.scrollLeft(a-this.m_scrollPanelRect.horizontalCenter());this.m_scrollPanel.scrollTop(b-this.m_scrollPanelRect.verticalCenter())}))};
primitives.orgdiagram.Controller.prototype._setOption=function(a,b){jQuery.Widget.prototype._setOption.apply(this,arguments);switch(a){case "disabled":var c=jQuery([]);b?(c.filter(".ui-state-focus").blur(),c.removeClass("ui-state-hover"),c.propAttr("disabled",!0),this.element.addClass("ui-disabled")):(c.propAttr("disabled",!1),this.element.removeClass("ui-disabled"))}};
primitives.orgdiagram.Controller.prototype._getTreeItemForMousePosition=function(a,b){var c=null,d,e,f,g,h,i,j,k,l;this.graphics.activate("placeholder",6);a/=this.scale;b/=this.scale;this.transform.transformPointBack(a,b,this,function(a,b){d=0;for(e=this._treeLevels.length;d<e;d+=1)if(g=this._treeLevels[d],b>g.topConnectorShift&&b<=g.connectorShift){i=h=null;k=0;for(f=g.treeItems.length;k<f;k+=1)switch(j=this._treeItems[g.treeItems[k]],j.actualVisibility){case 1:if(j.actualPosition.contains(a,b)){c=
j;return}case 2:case 3:if(l=Math.abs(j.actualPosition.horizontalCenter()-a),null===i||l<i)i=l,h=j}c=h;break}});return c};
primitives.orgdiagram.Controller.prototype._drawHighlightAnnotation=function(){var a=primitives.common,b,c,d,e,f,g,h,i,j,k,l=!0,m;if(null!==this._highlightTreeItem)switch(this._highlightTreeItem.actualVisibility){case 2:case 3:case 1:b=this._highlightTreeItem;c=b.itemConfig;switch(c.showCallout){case 2:l=!1;break;case 1:l=!1;break;default:l=this.options.showCallout}l?(d=new a.Rect(this.m_scrollPanel.scrollLeft(),this.m_scrollPanel.scrollTop(),Math.min(this.m_scrollPanelRect.width-25,this.m_placeholderRect.width),
Math.min(this.m_scrollPanelRect.height-25,this.m_placeholderRect.height)),this.graphics.activate("placeholder",6),this.transform.transformRect(b.actualPosition.x,b.actualPosition.y,b.actualPosition.width,b.actualPosition.height,this,function(l,n,q,r){f=new a.Rect(l,n,q,r);g=new a.Point(f.horizontalCenter(),f.verticalCenter());1!=this._highlightTreeItem.actualVisibility||!d.overlaps(f)?(j=!a.isNullOrEmpty(c.calloutTemplateName)?c.calloutTemplateName:!a.isNullOrEmpty(c.templateName)?c.templateName:
!a.isNullOrEmpty(this.options.defaultCalloutTemplateName)?this.options.defaultCalloutTemplateName:this.options.defaultTemplateName,k=this._templates[j],null==k&&(k=this._defaultTemplate),h=this._getAnnotationPosition(g,d,k.itemSize),e=new a.Rect(h),e.addRect(g.x,g.y),e.offset(50),m=e.getCSS(),m.display="inherit",m.visibility="inherit",this.m_calloutPlaceholder.css(m),g.x-=e.x,g.y-=e.y,h.x-=e.x,h.y-=e.y,i=new a.RenderEventArgs,i.context=b.itemConfig,i.isCursor=b.isCursor,i.isSelected=b.isSelected,
i.templateName=k.name,this.graphics.resize("calloutplaceholder",e.width,e.height),this.graphics.activate("calloutplaceholder",7),this.graphics.template(h.x,h.y,h.width,h.height,0,0,h.width,h.height,k.itemTemplate,k.itemTemplateHashCode,k.itemTemplateRenderName,i,null),this.pointerPlacement=0,this.m_calloutShape.cornerRadius=this.options.calloutCornerRadius,this.m_calloutShape.offset=this.options.calloutOffset,this.m_calloutShape.opacity=this.options.calloutOpacity,this.m_calloutShape.lineWidth=this.options.calloutLineWidth,
this.m_calloutShape.pointerWidth=this.options.calloutPointerWidth,this.m_calloutShape.borderColor=this.options.calloutBorderColor,this.m_calloutShape.fillColor=this.options.calloutfillColor,this.m_calloutShape.draw(g,h)):this.m_calloutPlaceholder.css({display:"none",visibility:"hidden"})})):this.m_calloutPlaceholder.css({display:"none",visibility:"hidden"});break;case 4:this.m_calloutPlaceholder.css({display:"none",visibility:"hidden"})}};
primitives.orgdiagram.Controller.prototype._hideHighlightAnnotation=function(){this.m_calloutPlaceholder.css({display:"none",visibility:"hidden"})};
primitives.orgdiagram.Controller.prototype._getAnnotationPosition=function(a,b,c){var d=new primitives.common.Rect(a.x,a.y,c.width,c.height);a.y>b.bottom()-b.height/4?(d.y-=c.height/2,d.x=a.x<b.horizontalCenter()?d.x+c.width/4:d.x-(c.width/4+c.width)):(d.y+=c.height/4,d.x-=c.width/2);d.x<b.x?d.x=b.x+5:d.right()>b.right()&&(d.x-=d.right()-b.right()+5);d.y<b.y?d.y=b.y+5:d.bottom()>b.bottom()&&(d.y-=d.bottom()-b.bottom()+5);return d};
primitives.orgdiagram.Controller.prototype._positionTreeItems=function(){var a=new primitives.common.Rect(0,0,(this.m_scrollPanelRect.width-25)/this.scale,(this.m_scrollPanelRect.height-25)/this.scale),b=new primitives.common.Rect(0,0,0,0),c,d,e,f,g;switch(this.options.orientationType){case primitives.orgdiagram.OrientationType.Left:case primitives.orgdiagram.OrientationType.Right:a.invert()}if(0<this._treeLevels.length){switch(this.options.pageFitMode){case 0:c=[new primitives.orgdiagram.LevelVisibility(0,
1)];b=this._setTreeLevelsVisibilityAndPositionTreeItems(c,0);break;default:c=[new primitives.orgdiagram.LevelVisibility(0,1)];b=[];switch(this.options.minimalVisibility){case 2:b.push(2);break;case 0:case 3:case 4:b.push(2),b.push(3)}for(d=this._treeLevels.length-1;0<=d;d-=1)for(e=0;e<b.length;e+=1)c.push(new primitives.orgdiagram.LevelVisibility(d,b[e]));d=this._setTreeLevelsVisibilityAndPositionTreeItems(c,c.length-1);d.addRect(a);d.offset(0,0,5,5);b=this._setTreeLevelsVisibilityAndPositionTreeItems(c,
0);if(!this._checkDiagramSize(b,d)&&(e=0,b=this._setTreeLevelsVisibilityAndPositionTreeItems(c,c.length-1),this._checkDiagramSize(b,d))){for(g=f=c.length-1;1<f-e;)g=Math.floor((f+e)/2),b=this._setTreeLevelsVisibilityAndPositionTreeItems(c,g),this._checkDiagramSize(b,d)?f=g:e=g;f!==g&&(b=this._setTreeLevelsVisibilityAndPositionTreeItems(c,f))}}b.width<a.width&&(this._stretchToWidth(b.width,a.width),b.width=a.width);b.height<a.height&&(b.height=a.height);switch(this.options.orientationType){case primitives.orgdiagram.OrientationType.Left:case primitives.orgdiagram.OrientationType.Right:b.invert()}this.m_placeholder.css(b.getCSS());
this.m_placeholderRect=new primitives.common.Rect(b)}};primitives.orgdiagram.Controller.prototype._checkDiagramSize=function(a,b){var c=!1;switch(this.options.pageFitMode){case 1:b.width>=a.width&&(c=!0);break;case 2:b.height>=a.height&&(c=!0);break;case 3:b.height>=a.height&&b.width>=a.width&&(c=!0)}return c};
primitives.orgdiagram.Controller.prototype._setTreeLevelsVisibilityAndPositionTreeItems=function(a,b){var c,d;for(c=0;c<this._treeLevels.length;c+=1)this._treeLevels[c].currentvisibility=1;for(c=0;c<=b;c+=1)d=a[c],this._treeLevels[d.level].currentvisibility=d.currentvisibility;this._recalcLevelsDepth();this._shiftLevels();this._setOffsets();return new primitives.common.Rect(0,0,this._getDiagramWidth(),this._getDiagramHeight())};
primitives.orgdiagram.Controller.prototype._getDiagramHeight=function(){return this._treeLevels[this._treeLevels.length-1].nextLevelShift};primitives.orgdiagram.Controller.prototype._getDiagramWidth=function(){var a=0,b,c;b=0;for(c=this._treeLevels.length;b<c;b+=1)a=Math.max(a,this._treeLevels[b].currentOffset);return a+=this.options.normalItemsInterval};
primitives.orgdiagram.Controller.prototype._setOffsets=function(){var a,b;a=0;for(b=this._treeLevels.length;a<b;a+=1)this._treeLevels[a].currentOffset=0;void 0!==this._treeItems[this._visualRootItem]&&this._setOffset(this._treeItems[this._visualRootItem])};
primitives.orgdiagram.Controller.prototype._setOffset=function(a){var b=this._treeLevels[a.level],c=this._itemsInterval[0===a.visibility?b.currentvisibility:a.visibility]/2,d,e,f,g,h,i;a.leftPadding=c+(0<b.currentOffset?c*a.relationDegree*this.options.cousinsIntervalMultiplier:0);a.rightPadding=c;a.offset=b.currentOffset+a.leftPadding;b.currentOffset=a.offset+a.actualSize.width+a.rightPadding;if(0<a.visualChildren.length){b=0;for(d=a.visualChildren.length;b<d;b+=1)this._setOffset(this._treeItems[a.visualChildren[b]]);
c=this._getChildrenOffset(a);if(0<c)this._offsetItemChildren(a,c);else if(0>c&&(c=-c,this._offsetItem(a,c),d=null,e={},g=null,h=this._getParentItem(a),null!==h)){for(b=h.visualChildren.length-1;0<=b;b-=1)if(i=h.visualChildren[b],i===a)d=[];else if(null!==d)if(f=this._getGapBetweenSiblings(i,a),e[i.id]=f,0<f)d.splice(0,0,i);else{g=i;break}if(0<d.length){if(null!==g){f=[g];f=f.concat(d);f.push(a);g=[[g]];b=1;for(d=f.length;b<d;b+=1)a=f[b-1],h=f[b],3===a.connectorPlacement||7===h.connectorPlacement?
g[g.length-1].push(h):g.push([h])}else g=[d.slice(0)],g[g.length-1].push(a);if(0<g.length){d=g[g.length-1];for(b=d.length-2;0<=b;b-=1)a=d[b],f=e[a.id],c=Math.min(f,c),this._offsetItem(a,c),this._offsetItemChildren(a,c)}h=c/(g.length-1);for(d=g.length-2;0<d;d-=1){i=g[d];for(b=i.length-1;0<=b;b-=1)a=i[b],f=e[a.id],c=Math.min(d*h,Math.min(f,c)),this._offsetItem(a,c),this._offsetItemChildren(a,c)}}}}};
primitives.orgdiagram.Controller.prototype._getGapBetweenSiblings=function(a,b){var c=null,d=this._getRightMargins(a),e=this._getLeftMargins(b),f=Math.min(d.length,e.length),g,h;for(g=0;g<f&&!(h=e[g]-d[g],c=null!==c?Math.min(c,h):h,0>=h);g+=1);return Math.floor(c)};
primitives.orgdiagram.Controller.prototype._getRightMargins=function(a){var b=[],c,d,e;c=this._rightMargins[a];void 0===c&&(c=[]);c=c.slice();c.splice(0,0,a.id);a=0;for(d=c.length;a<d;a+=1)e=this._treeItems[c[a]],b[a]=e.offset+e.actualSize.width+e.rightPadding;return b};
primitives.orgdiagram.Controller.prototype._getLeftMargins=function(a){var b=[],c,d,e;c=this._leftMargins[a];void 0===c&&(c=[]);c=c.slice();c.splice(0,0,a.id);a=0;for(d=c.length;a<d;a+=1)e=this._treeItems[c[a]],b[a]=e.offset-e.leftPadding;return b};
primitives.orgdiagram.Controller.prototype._getChildrenOffset=function(a){var b=a.offset+a.actualSize.width/2,c=null,d,e,f;if(null===a.visualAggregatorId){a=a.visualChildren;d=null;f=0;for(e=a.length;f<e&&!(d=this._treeItems[a[f]],1===d.connectorPlacement);f+=1);e=null;for(f=a.length-1;0<=f&&!(e=this._treeItems[a[f]],1===e.connectorPlacement);f-=1);switch(this.options.horizontalAlignment){case 1:c=d.offset+d.actualSize.width/2;break;case 2:c=e.offset+e.actualSize.width/2;break;case 0:c=(d.offset+
e.offset+e.actualSize.width)/2}}else c=this._treeItems[a.visualAggregatorId],c=c.offset+c.actualSize.width/2;return b-c};primitives.orgdiagram.Controller.prototype._getParentItem=function(a){var b=null;null!==a&&null!==a.visualParentId&&(b=this._treeItems[a.visualParentId]);return b};primitives.orgdiagram.Controller.prototype._offsetItem=function(a,b){a.offset+=b;var c=this._treeLevels[a.level];c.currentOffset=Math.max(c.currentOffset,a.offset+a.actualSize.width)};
primitives.orgdiagram.Controller.prototype._offsetItemChildren=function(a,b){var c=a.visualChildren,d,e,f;if(0<c.length){d=null;e=0;for(f=c.length;e<f;e+=1)d=this._treeItems[c[e]],d.offset+=b,this._offsetItemChildren(d,b);c=this._treeLevels[d.level];c.currentOffset=Math.max(c.currentOffset,d.offset+d.actualSize.width)}};
primitives.orgdiagram.Controller.prototype._stretchToWidth=function(a,b){var c,d;switch(this.options.horizontalAlignment){case 1:c=0;break;case 2:c=b-a;break;case 0:c=(b-a)/2}if(0<c)for(d in this._treeItems)this._treeItems.hasOwnProperty(d)&&(this._treeItems[d].offset+=c)};
primitives.orgdiagram.Controller.prototype._recalcLevelsDepth=function(){var a,b,c,d;a=0;for(b=this._treeLevels.length;a<b;a+=1)c=this._treeLevels[a],c.shift=0,c.depth=0,c.actualVisibility=4;for(d in this._treeItems)this._treeItems.hasOwnProperty(d)&&(a=this._treeItems[d],c=this._treeLevels[a.level],a.setActualSize(c,this.options),c.depth=Math.max(c.depth,a.actualSize.height),c.actualVisibility=Math.min(c.actualVisibility,a.actualVisibility))};
primitives.orgdiagram.Controller.prototype._shiftLevels=function(){var a=this.options.lineLevelShift,b,c,d,e;b=0;for(c=this._treeLevels.length;b<c;b+=1)d=this._treeLevels[b],d.shift=a,e=this._getLevelShift(d.actualVisibility),d.connectorShift=d.shift+d.depth+e/2,d.topConnectorShift=d.shift-e/2,a+=d.depth+e,d.nextLevelShift=a};
primitives.orgdiagram.Controller.prototype._getLevelShift=function(a){var b=0;switch(a){case 1:b=this.options.normalLevelShift;break;case 2:b=this.options.dotLevelShift;break;case 3:case 4:b=this.options.lineLevelShift}return b};
primitives.orgdiagram.Controller.prototype._readTemplates=function(){var a,b;this._templates={};a=new primitives.orgdiagram.Template(new primitives.orgdiagram.TemplateConfig);a.name=this.widgetEventPrefix+"Template";a.createDefaultTemplates(this.options);this._templates[a.name]=a;for(a=0;a<this.options.templates.length;a+=1)b=this.options.templates[a],b=new primitives.orgdiagram.Template(b),b.createDefaultTemplates(this.options),this._templates[b.name]=b};
primitives.orgdiagram.Controller.prototype._onDefaultTemplateRender=function(a,b){var c=b.context,d=primitives.common.highestContrast(c.itemTitleColor,this.options.itemTitleSecondFontColor,this.options.itemTitleFirstFontColor);b.element.find("[name=titleBackground]").css({background:c.itemTitleColor});b.element.find("[name=photo]").attr({src:c.image,alt:c.title});b.element.find("[name=title]").css({color:d}).text(c.title);b.element.find("[name=description]").text(c.description)};
primitives.orgdiagram.Controller.prototype._createCheckBoxTemplate=function(){var a=jQuery("<div></div>");a.addClass("bp-item bp-selectioncheckbox-frame");a.append(jQuery('<label><nobr><input type="checkbox" name="checkbox" class="bp-selectioncheckbox" />&nbsp;<span name="selectiontext" class="bp-selectiontext">'+this.options.selectCheckBoxLabel+"</span></nobr></label>"));this._checkBoxTemplate=a.wrap("<div>").parent().html();this._checkBoxTemplateHashCode=primitives.common.hashCode(this._checkBoxTemplate)};
primitives.orgdiagram.Controller.prototype._onCheckBoxTemplateRender=function(a,b){b.element.find("[name=checkbox]").prop("checked",b.isSelected)};primitives.orgdiagram.Controller.prototype._createGroupTitleTemplate=function(){var a=jQuery("<div></div>");a.addClass("bp-item bp-corner-all bp-grouptitle-frame");this._groupTitleTemplate=a.wrap("<div>").parent().html();this._groupTitleTemplateHashCode=primitives.common.hashCode(this._groupTitleTemplate)};
primitives.orgdiagram.Controller.prototype._onGroupTitleTemplateRender=function(a,b){var c=new primitives.text.Config;c.orientation=2;c.horizontalAlignment=0;c.verticalAlignment=1;c.text=b.itemConfig.groupTitle;c.fontSize="12px";c.color=primitives.common.highestContrast(b.itemConfig.groupTitleColor,this.options.itemTitleSecondFontColor,this.options.itemTitleFirstFontColor);c.fontFamily="Verdana";switch(b.renderingMode){case 0:b.element.bpText(c);break;case 1:b.element.bpText("option",c),b.element.bpText("update")}primitives.common.css(b.element,
{background:b.itemConfig.groupTitleColor})};primitives.orgdiagram.Controller.prototype._createButtonsTemplate=function(){var a=jQuery("<ul></ul>");a.css({position:"absolute"}).addClass("ui-widget ui-helper-clearfix");this._buttonsTemplate=a.wrap("<div>").parent().html();this._buttonsTemplateHashCode=primitives.common.hashCode(this._buttonsTemplate)};
primitives.orgdiagram.Controller.prototype._onButtonsTemplateRender=function(a,b){var c=0,d,e,f;switch(b.renderingMode){case 0:for(f=0;f<this.options.buttons.length;f+=1)d=this.options.buttons[f],e=jQuery('<li data-buttonname="'+d.name+'"></li>').css({position:"absolute",top:c+"px",left:"0px",width:d.size.width+"px",height:d.size.height+"px",padding:"3px"}).addClass(this.widgetEventPrefix+"button"),b.element.append(e),e.button({icons:{primary:d.icon},text:d.text,label:d.label}),c+=10+d.size.height}};
primitives.orgdiagram.Controller.prototype._readTreeItems=function(){var a;this._highlightTreeItem=this._cursorTreeItem=null;this._selectedTreeItems.length=0;this._defaultTemplate=null;this._defaultTemplate=this._templates[this.options.defaultTemplateName];void 0===this._defaultTemplate&&(this._defaultTemplate=this._templates[this.widgetEventPrefix+"Template"]);this._treeItemCounter=0;this._treeItems={};this._treeLevels=[];this._leftMargins={};this._rightMargins={};this._visualRootItem=0;if(null!==
this.options.rootItem){a=this._getNewTreeItem({itemConfig:this.options.rootItem});switch(a.itemConfig.itemType){case 2:case 5:case 1:case 4:a.actualItemType=0;break;default:a.actualItemType=a.itemConfig.itemType}a.visibility=3===a.actualItemType||!a.itemConfig.isVisible?4:0;this._createVisualTree(a);this._readVisualTree(this._treeItems[this._visualRootItem],0);this._showSelectedItems();this._showCursorNeigbours()}};
primitives.orgdiagram.Controller.prototype._getNewTreeItem=function(a){var b=new primitives.orgdiagram.TreeItem(this._treeItemCounter),c;for(c in a)a.hasOwnProperty(c)&&(b[c]=a[c]);this._treeItemCounter+=1;return this._treeItems[b.id]=b};
primitives.orgdiagram.Controller.prototype._createVisualTree=function(a){var b,c,d,e,f,g,h,i;g=[];f=a.itemConfig.items.slice(0);h=0;for(e=f.length;h<e;h+=1)if(c=f[h],this._hasVisibleChildren(c))switch(b=this._getNewTreeItem({itemConfig:c,logicalParentId:a.id,visualParentId:a.id,actualItemType:c.itemType}),g.push(b),this._getFirstLogicalVisibleParent(a).logicalChildren.push(b),b.visibility=3===b.actualItemType||!b.itemConfig.isVisible?4:0,b.actualItemType){case 5:b=this._createNewVisualParent(b);case 2:null===
a.visualParentId&&this._createNewVisualRoot(a);d=this._treeItems[a.visualParentId];switch(a.connectorPlacement){case 1:switch(c.adviserPlacementType){case 2:c=this._findLeftSiblingIndex(d.visualChildren,a);d.visualChildren.splice(c+1,0,b);b.connectorPlacement=3;break;default:c=this._findRightSiblingIndex(d.visualChildren,a),d.visualChildren.splice(c,0,b),b.connectorPlacement=7}break;case 3:c=this._findLeftSiblingIndex(d.visualChildren,a);d.visualChildren.splice(c+1,0,b);b.connectorPlacement=3;break;
case 7:c=this._findRightSiblingIndex(d.visualChildren,a),d.visualChildren.splice(c,0,b),b.connectorPlacement=7}b.visualParentId=a.visualParentId;break;case 4:b=this._createNewVisualParent(b);case 1:null===a.visualAggregatorId&&this._createNewVisualAggregator(a);switch(c.adviserPlacementType){case 2:a.visualChildren.splice(0,0,b);b.connectorPlacement=3;break;default:a.visualChildren.push(b),b.connectorPlacement=7}b.visualParentId=a.id;break;case 0:case 3:d=a,null!==a.visualAggregatorId&&(d=this._treeItems[a.visualAggregatorId]),
d.visualChildren.push(b),b.visualParentId=d.id}b=[];d=[];this._layoutChildren(a,b,d);h=0;for(e=g.length;h<e;h+=1)this._createVisualTree(g[h]);if(null!==a.visualAggregatorId&&(e=this._treeItems[a.visualAggregatorId],0<e.visualChildren.length&&(g=this._getAssitantsDepth(a),1<g)))for(h=0;h<g-1;h+=1)e=this._createNewVisualAggregator(e);if(0<a.visualChildren.length&&(g=this._getAdvisersDepth(a),1<g)){e=a;for(h=0;h<g-1;h+=1)e=this._createNewVisualAggregator(e)}c=[];h=0;for(e=d.length;h<e;h+=1){g=d[h];a=
c[h]=0;for(f=g.length;a<f;a+=1)c[h]=Math.max(c[h],this._getItemDepth(g[a]))}h=0;for(e=c.length;h<e;h+=1)if(d=c[h],1<d){a=0;for(f=b[h].length;a<f;a+=1)if(i=b[h][a],0<i.visualChildren.length)for(g=d;1<g;)i=this._createNewVisualAggregator(i),g-=1}};primitives.orgdiagram.Controller.prototype._getFirstLogicalVisibleParent=function(a){var b=a;4===a.visibility&&null!=a.logicalParentId&&(b=this._getFirstLogicalVisibleParent(this._treeItems[a.logicalParentId]));return b};
primitives.orgdiagram.Controller.prototype._createNewVisualParent=function(a){var b;b=this._getNewTreeItem({visibility:4,visualChildren:[a]});a.visualParentId=b.id;return b};primitives.orgdiagram.Controller.prototype._hasVisibleChildren=function(a){var b=!0,c,d;if(3===a.itemType||!a.isVisible){b=!1;c=0;for(d=a.items.length;c<d;c+=1)if(this._hasVisibleChildren(a.items[c])){b=!0;break}}return b};
primitives.orgdiagram.Controller.prototype._getAdvisersDepth=function(a){var b=0,c=this._getParentItem(a),d,e;if(null!==c){a=primitives.common.indexOf(c.visualChildren,a);for(d=a+1;d<c.visualChildren.length;d+=1)if(e=c.visualChildren[d],7===e.connectorPlacement)b=Math.max(b,this._getItemDepth(e));else break;for(d=a-1;0<=d;d-=1)if(e=c.visualChildren[d],3===e.connectorPlacement)b=Math.max(b,this._getItemDepth(e));else break}return b};
primitives.orgdiagram.Controller.prototype._getAssitantsDepth=function(a){var b=0,c,d;for(c=0;c<a.visualChildren.length;c+=1)d=a.visualChildren[c],1!==d.connectorPlacement&&(b=Math.max(b,this._getItemDepth(d)));return b};primitives.orgdiagram.Controller.prototype._getItemDepth=function(a){var b=0,c,d;c=0;for(d=a.visualChildren.length;c<d;c+=1)b=Math.max(b,this._getItemDepth(a.visualChildren[c]));return b+1};
primitives.orgdiagram.Controller.prototype._layoutChildren=function(a,b,c){var d,e,f,g,h,i,j,k,l,m;f=a.itemConfig.childrenPlacementType;switch(this.options.horizontalAlignment){case 0:case 1:e=3;break;case 2:e=2}0===f&&(f=this._hasLeavesOnly(a)?0===this.options.leavesPlacementType?3:this.options.leavesPlacementType:0===this.options.childrenPlacementType?2:this.options.childrenPlacementType);d=a;null!==a.visualAggregatorId&&(d=this._treeItems[a.visualAggregatorId]);switch(f){case 2:0<d.visualChildren.length&&
(this._treeItems[d.visualChildren[0]].relationDegree=1);break;case 3:if(3<d.visualChildren.length){a=d.visualChildren.slice(0);d.visualChildren.length=0;i=Math.min(this.options.maximumColumnsInMatrix,Math.ceil(Math.sqrt(a.length)));j=Math.ceil(a.length/i);k=Math.ceil(i/2);for(l=0;l<k;l+=1){e=d;for(m=0;m<j;m+=1){f=this._getMatrixItem(a,2*l,m,i,j);g=this._getMatrixItem(a,2*l+1,m,i,j);void 0===b[m]&&(b[m]=[],c[m]=[]);null!==f&&(0==l&&(f.relationDegree=1),e.visualChildren.push(f),f.visualParentId=e.id,
f.connectorPlacement=3,c[m].push(f));if(null!==f||null!==g)h=this._getNewTreeItem({visibility:4,visualParentId:e.id}),e.visualChildren.push(h),e.visualAggregatorId=h.id,b[m].push(h);null!==g&&(e.visualChildren.push(g),g.visualParentId=e.id,g.connectorPlacement=7,c[m].push(g));e=h}}2<i&&(d.visualAggregatorId=null)}break;case 1:a=d.visualChildren.slice(0);g=d.visualChildren.length=0;for(i=a.length;g<i;g+=1){f=a[g];h=this._getNewTreeItem({visibility:4,visualParentId:d.id});d.visualAggregatorId=h.id;
f.visualParentId=d.id;switch(e){case 2:d.visualChildren.push(f);d.visualChildren.push(h);f.connectorPlacement=3;break;case 3:d.visualChildren.push(h),d.visualChildren.push(f),f.connectorPlacement=7}b[g]=[h];c[g]=[f];d=h}}};primitives.orgdiagram.Controller.prototype._getMatrixItem=function(a,b,c,d){0<d%2&&(b===d-1?b=a.length:b===d&&(b=d-1));b=c*d+b;return b>a.length-1?null:a[b]};
primitives.orgdiagram.Controller.prototype._hasLeavesOnly=function(a){var b=!1,c,d,e;if(null!==a.itemConfig&&(e=a.itemConfig.items,c=e.length,0<c)){b=!0;for(a=0;a<c;a+=1)if(d=e[a],(0===d.itemType||3===d.itemType)&&0<d.items.length){b=!1;break}}return b};primitives.orgdiagram.Controller.prototype._findLeftSiblingIndex=function(a,b){var c=null,d,e;for(e=a.length-1;0<=e;e-=1)if(d=a[e],null===c)d===b&&(c=-1);else if(0===d.actualItemType||3===d.actualItemType){c=e;break}return c};
primitives.orgdiagram.Controller.prototype._findRightSiblingIndex=function(a,b){var c=null,d,e,f;e=0;for(f=a.length;e<f;e+=1)if(d=a[e],null===c)d===b&&(c=f);else if(0===d.actualItemType||3===d.actualItemType){c=e;break}return c};primitives.orgdiagram.Controller.prototype._createNewVisualRoot=function(a){var b=this._getNewTreeItem({visibility:4,visualParentId:null});b.visualChildren.push(a);this._visualRootItem=a.visualParentId=b.id};
primitives.orgdiagram.Controller.prototype._createNewVisualAggregator=function(a){var b,c;b=this._getNewTreeItem({visibility:4,visualParentId:a.id,visualAggregatorId:a.visualAggregatorId});b.visualChildren=a.visualChildren;for(c=0;c<b.visualChildren.length;c+=1)b.visualChildren[c].visualParentId=b.id;a.visualChildren=[b];a.visualAggregatorId=b.id;return b};
primitives.orgdiagram.Controller.prototype._readVisualTree=function(a,b){var c=this._treeLevels[b],d,e;void 0===c&&(c=this._treeLevels[b]=new primitives.orgdiagram.TreeLevel(b));c.treeItems.push(a.id);a.level=b;a.levelPosition=c.treeItems.length-1;c=a.itemConfig;null!==c&&(d=this._templates[c.templateName],a.template=void 0!==d?d:this._defaultTemplate,c===this.options.cursorItem&&(this._cursorTreeItem=a,this._cursorTreeItem.isCursor=!0),c===this.options.highlightItem&&(this._highlightTreeItem=a),
0<=primitives.common.indexOf(this.options.selectedItems,c)&&this._selectedTreeItems.push(a),a.hasSelectorCheckbox=this._getSelectionVisibility(a.isCursor,c.hasSelectorCheckbox,this.options.hasSelectorCheckbox),a.hasButtons=0<this.options.buttons.length&&this._getSelectionVisibility(a.isCursor,c.hasButtons,this.options.hasButtons));c=0;for(d=a.visualChildren.length;c<d;c+=1)e=a.visualChildren[c],0===c&&this._updateLeftMargins(e,0),c===d-1&&this._updateRightMargins(e,0),this._readVisualTree(e,b+1)};
primitives.orgdiagram.Controller.prototype._updateLeftMargins=function(a,b){for(var c=a,d;null!==(c=this._getParentItem(c));)d=this._leftMargins[c.id],void 0===d&&(d=this._leftMargins[c.id]=[]),void 0===d[b]&&(d[b]=a.id),b+=1};primitives.orgdiagram.Controller.prototype._updateRightMargins=function(a,b){for(var c=a,d;null!==(c=this._getParentItem(c));)d=this._rightMargins[c.id],void 0===d&&(d=this._rightMargins[c.id]=[]),d[b]=a.id,b+=1};
primitives.orgdiagram.Controller.prototype._showSelectedItems=function(){var a,b;for(a=0;a<this._selectedTreeItems.length;a+=1)switch(b=this._selectedTreeItems[a],b.isSelected=!0,0===b.visibility&&(b.visibility=1),this.options.selectionPathMode){case 1:for(;void 0!==b;)0===b.visibility&&(b.visibility=1),b=this._treeItems[b.logicalParentId]}};
primitives.orgdiagram.Controller.prototype._showCursorNeigbours=function(){var a,b,c;if(null!==this._cursorTreeItem){for(a=0;a<this._cursorTreeItem.logicalChildren.length;a+=1)b=this._cursorTreeItem.logicalChildren[a],0===b.visibility&&(b.visibility=1);for(b=this._cursorTreeItem;void 0!==b;)0===b.visibility&&(b.visibility=1),b=this._treeItems[b.logicalParentId];c=this._treeItems[this._cursorTreeItem.logicalParentId];if(null!=c){c=this._getFirstLogicalVisibleParent(c);for(a=0;a<c.logicalChildren.length;a+=
1)b=c.logicalChildren[a],0===b.visibility&&(b.visibility=1)}}};primitives.orgdiagram.Controller.prototype._getSelectionVisibility=function(a,b,c){var d=!1;switch(b){case 0:switch(c){case 0:d=a;break;case 1:d=!0;break;case 2:d=!1}break;case 1:d=!0;break;case 2:d=!1}return d};primitives.orgdiagram.LevelVisibility=function(a,b){this.level=a;this.currentvisibility=b};
primitives.orgdiagram.Template=function(a){this.widgetEventPrefix="orgdiagram";this.templateConfig=a;this.name=a.name;this.itemSize=a.itemSize;this.itemBorderWidth=a.itemBorderWidth;this.minimizedItemSize=a.minimizedItemSize;this.highlightPadding=a.highlightPadding;this.highlightBorderWidth=a.highlightBorderWidth;this.cursorPadding=a.cursorPadding;this.cursorBorderWidth=a.cursorBorderWidth;this.itemTemplate=a.itemTemplate;this.highlightTemplate=a.highlightTemplate;this.cursorTemplate=a.cursorTemplate;
this.itemTemplateHashCode=null;this.itemTemplateRenderName="onItemRender";this.highlightTemplateHashCode=null;this.highlightTemplateRenderName="onHighlightRender";this.cursorTemplateHashCode=null;this.cursorTemplateRenderName="onCursorRender";this.boxModel=jQuery.support.boxModel};
primitives.orgdiagram.Template.prototype.createDefaultTemplates=function(a){primitives.common.isNullOrEmpty(this.itemTemplate)&&(this.itemTemplate=this._getDefaultItemTemplate(a),this.itemTemplateRenderName="onDefaultTemplateRender");this.itemTemplateHashCode=primitives.common.hashCode(this.itemTemplate);primitives.common.isNullOrEmpty(this.cursorTemplate)&&(this.cursorTemplate=this._getDefaultCursorTemplate(a),this.cursorTemplateRenderName=null);this.cursorTemplateHashCode=primitives.common.hashCode(this.cursorTemplate);
primitives.common.isNullOrEmpty(this.highlightTemplate)&&(this.highlightTemplate=this._getDefaultHighlightTemplate(),this.highlightTemplateRenderName=null);this.highlightTemplateHashCode=primitives.common.hashCode(this.highlightTemplate)};
primitives.orgdiagram.Template.prototype._getDefaultItemTemplate=function(){var a=new primitives.common.Size(this.itemSize),b,c,d;a.width-=this.boxModel?2*this.itemBorderWidth:0;a.height-=this.boxModel?2*this.itemBorderWidth:0;b=jQuery("<div></div>").css({"border-width":this.itemBorderWidth+"px"}).addClass("bp-item bp-corner-all bt-item-frame");c=jQuery('<div name="titleBackground"></div>').css({top:"2px",left:"2px",width:a.width-4+"px",height:"18px"}).addClass("bp-item bp-corner-all bp-title-frame");
b.append(c);d=jQuery('<div name="title"></div>').css({top:"1px",left:"4px",width:a.width-4-8+"px",height:"16px"}).addClass("bp-item bp-title");c.append(d);c=jQuery("<div></div>").css({top:"24px",left:"2px",width:"50px",height:"60px"}).addClass("bp-item bp-photo-frame");b.append(c);d=jQuery('<img name="photo" alt=""></img>').css({width:"50px",height:"60px"});c.append(d);a=jQuery('<div name="description"></div>').css({top:"24px",left:"56px",width:a.width-4-56+"px",height:"74px"}).addClass("bp-item bp-description");
b.append(a);return b.wrap("<div>").parent().html()};primitives.orgdiagram.Template.prototype._getDefaultCursorTemplate=function(){return jQuery("<div></div>").css({width:this.itemSize.width+this.cursorPadding.left+this.cursorPadding.right+"px",height:this.itemSize.height+this.cursorPadding.top+this.cursorPadding.bottom+"px","border-width":this.cursorBorderWidth+"px"}).addClass("bp-item bp-corner-all bp-cursor-frame").wrap("<div>").parent().html()};
primitives.orgdiagram.Template.prototype._getDefaultHighlightTemplate=function(){return jQuery("<div></div>").css({"border-width":this.highlightBorderWidth+"px"}).addClass("bp-item bp-corner-all bp-highlight-frame").wrap("<div>").parent().html()};
primitives.orgdiagram.TreeItem=function(a){this.id=a;this.visualParentId=this.logicalParentId=this.itemConfig=null;this.visualChildren=[];this.logicalChildren=[];this.visualAggregatorId=null;this.visibility=1;this.levelPosition=this.level=this.template=null;this.rightPadding=this.leftPadding=this.offset=0;this.actualVisibility=1;this.contentPosition=this.actualPosition=this.actualSize=null;this.hasGroupTitle=this.hasButtons=this.hasSelectorCheckbox=this.isSelected=this.isCursor=!1;this.actualItemType=
null;this.connectorPlacement=1;this.relationDegree=0};
primitives.orgdiagram.TreeItem.prototype.setActualSize=function(a,b){var c=primitives.common;this.actualVisibility=0===this.visibility?a.currentvisibility:this.visibility;switch(this.actualVisibility){case 1:this.actualSize=new c.Size(this.template.itemSize);this.contentPosition=new c.Rect(0,0,this.actualSize.width,this.actualSize.height);this.isCursor&&(this.actualSize.height+=this.template.cursorPadding.top+this.template.cursorPadding.bottom,this.actualSize.width+=this.template.cursorPadding.left+
this.template.cursorPadding.right,this.contentPosition.x=this.template.cursorPadding.left,this.contentPosition.y=this.template.cursorPadding.top);this.hasSelectorCheckbox&&(this.actualSize.height+=b.checkBoxPanelSize);this.hasButtons&&(this.actualSize.width+=b.buttonsPanelSize);if(this.hasGroupTitle=!c.isNullOrEmpty(this.itemConfig.groupTitle))this.actualSize.width+=b.groupTitlePanelSize,this.contentPosition.x+=b.groupTitlePanelSize;break;case 2:this.actualSize=new c.Size(this.template.minimizedItemSize);
break;case 3:case 4:this.actualSize=new c.Size}switch(b.orientationType){case primitives.orgdiagram.OrientationType.Left:case primitives.orgdiagram.OrientationType.Right:this.actualSize.invert()}};
primitives.orgdiagram.TreeItem.prototype.setActualPosition=function(a,b){var c=0;switch(b.verticalAlignment){case 0:c=0;break;case 1:c=(a.depth-this.actualSize.height)/2;break;case 2:c=a.depth-this.actualSize.height}this.actualPosition=new primitives.common.Rect(this.offset,a.shift+c,this.actualSize.width,this.actualSize.height);switch(b.orientationType){case primitives.orgdiagram.OrientationType.Left:case primitives.orgdiagram.OrientationType.Right:this.actualSize.invert()}};
primitives.orgdiagram.TreeItem.prototype.toString=function(){return this.id};primitives.orgdiagram.TreeLevel=function(a){this.level=a;this.actualVisibility=this.currentvisibility=1;this.connectorShift=this.topConnectorShift=this.currentOffset=this.nextLevelShift=this.depth=this.shift=0;this.treeItems=[];this.labels=[];this.labelsRect=null;this.showLabels=!0;this.hasFixedLabels=!1};primitives.orgdiagram.TreeLevel.prototype.toString=function(){return this.level+"."+this.currentvisibility};
(function(a){a.widget("ui.orgDiagram",jQuery.ui.mouse2,new primitives.orgdiagram.Controller)})(jQuery);
